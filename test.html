<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="style.css"> -->
    <title>bitOffice</title>
    <style>
        *{box-sizing:border-box}html{background-color:#add8e6}input:invalid{background-color:orange}tr:hover:not(#tables-table>thead>tr,#tables-table>tbody>tr,#tables-table>tfoot>tr,#calculator-tabletr){background-color:#fff}#tables-table td:first-of-type:hover,#tables-table th:hover:not(:first-of-type){background-color:#fff}th:hover{background-color:#d3d3d3}.table-container{display:block;overflow-x:auto;margin-left:auto;margin-right:auto;width:90%;text-align:center}table{background-color:#add8e6}table{min-width:100%}tr{text-align:left;height:1rem}td{background-color:#ff0}main{width:320px;margin:auto;background-color:#ff0;display:flex;flex-direction:column;align-items:center;padding-bottom:20px}main>*{width:90%}#calendar-edit-form,main>div:not(#document-parent,#calculator-result-row){display:flex;flex-direction:column;align-items:center}main>nav{display:flex;flex-direction:row;flex-wrap:wrap}#back-nav,#top-nav{background-color:#ff0}main input,main>select{width:240px}main>button{width:120px}main>input,select{text-align:center}#main-calendar-start>button{width:240px}#calendar-date{height:3rem;text-align:center;font-size:1.4em}#tables-table{display:block;margin:auto;min-width:100%}#tables-table th:not(:last-of-type){min-width:5rem}#tables-table th:first-of-type{min-width:0}#tables-table td{width:auto}#main-tables-header-form button,#main-tables-header-form input,#main-tables-header-form select,#main-tables-row-form button,#main-tables-row-form select{width:200px}#add-column,#add-row,#blank-th{width:auto}#tables-table input{width:100%}#contacts-table>table{margin:auto;display:block}#contacts-table>table>thead>tr>th:nth-of-type(2){min-width:7rem}#contacts-table td,#contacts-table th{display:none}#contacts-table td:nth-of-type(1),#contacts-table th:nth-of-type(1){display:table-cell;width:100%}#contacts-table td:nth-of-type(2),#contacts-table th:nth-of-type(2){display:table-cell}#add-column,#add-row,#blank-th{width:auto}#tables-table input{width:100%}main>input,select{text-align:center}h1:not(#document-resulth1){background-color:#add8e6;text-align:center}nav{background-color:#add8e6}#note{height:400px;max-width:90%}#text-editor{height:200px;max-width:90%}.mono{font-family:'Courier New',Courier,monospace}.serif{font-family:Georgia,'Times New Roman',Garamond,Times,serif}.sans{font-family:Arial,Verdana,Helvetica,Tahoma,sans-serif}#document-settings,#edit-bar{width:90%;display:flex;flex-direction:row;flex-wrap:wrap;margin:0;padding:0;background-color:#5f9ea0;border:1px solid #000}#text-editor{width:90%;max-width:90%;overflow-wrap:break-word;min-height:100px;margin-top:0;margin-bottom:0}#document-parent{margin:0;padding:0;width:90%;background-color:#fafad2}pre{white-space:pre-wrap;overflow-wrap:break-word}.filler{flex-grow:1}#calculator-table{width:90%;min-width:0}#calculator-table td button{font-size:2rem;width:100%;height:4rem}.special-calculator-button{background-color:#fc3;border:1px solid grey}#calculator-result-row{display:flex;flex-direction:row}#calculator-result-row *{font-size:1.4rem}#calculator-result-row input{width:60%}#expression-span{overflow-wrap:anywhere;min-height:18px;color:grey}html{background-color:#bdbdbd}body{background-color:#e0e0e0;width:320px;margin:auto}main,nav>button,td{background-color:#e0e0e0;border-radius:5px}main>button{background-color:#bdbdbd;min-height:30px;border-radius:5px;padding:3px;margin:2px}main>button:hover{background-color:#e0e0e0}nav>button:hover{background-color:#bdbdbd}#top-nav button{padding:5px;margin:1px;min-height:25px}#file-bar button,#main-calendar-table button,#main-contacts-table button,#main-notes button,#main-tables-table button{padding:5px;margin:1px;min-height:25px}h1:not(#document-resulth1){background-color:#0000cd;text-align:center;padding:2px;border-radius:5px;font-family:Arial,Helvetica,sans-serif}h1:not(#document-resulth1){color:#e6e6fa;font-family:Arial,Helvetica,sans-serif;width:320px;margin:auto;border-radius:0}nav:not(#document-settings,#edit-bar,#top-nav,#back-nav){border-radius:5px;margin:5px;background-color:#bdbdbd}#back-nav,#top-nav{background-color:#0000cd;width:320px;margin:auto;display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap}#back-nav button,#top-nav button{font-size:1.4rem}table{border-radius:5px;background-color:#bdbdbd}input:not(#tables-tableinput,#calendar-date,#calculator-input),select{background-color:#f5f5f5;min-height:30px;border-radius:5px}button,table{border:1px solid grey}#main-notes h2{background-color:khaki;border:1px solid grey;text-align:center;padding:2px;border-radius:5px;font-family:Arial,Helvetica,sans-serif}#main-help h2,#main-startup h2{background-color:#0000cd;color:#e6e6fa;text-align:center;padding:2px;border-radius:5px;font-family:Arial,Helvetica,sans-serif}#main-write h2:not(#document-resulth2){background-color:#5f9ea0;text-align:center;padding:2px;border-radius:5px;font-family:Arial,Helvetica,sans-serif;color:#faebd7;border:1px solid grey}#main-contacts-form h2,#main-contacts-table h2{background-color:indigo;text-align:center;padding:2px;border-radius:5px;font-family:Arial,Helvetica,sans-serif;color:#faebd7;border:1px solid grey}#main-calendar-form h2,#main-calendar-form h3,#main-calendar-start h2,#main-calendar-start h3,#main-calendar-table h2,#main-calendar-table h3{background-color:#ff8c00;text-align:center;padding:2px;border-radius:5px;font-family:Arial,Helvetica,sans-serif;border:1px solid grey}#main-tables-header-form h2,#main-tables-header-form h3,#main-tables-row-form h2,#main-tables-row-form h3,#main-tables-table h2,#main-tables-table h3{background-color:#228b22;text-align:center;padding:2px;border-radius:5px;font-family:Arial,Helvetica,sans-serif;color:#faebd7;border:1px solid grey}#main-calculator h2{background-color:#696969;text-align:center;padding:2px;border-radius:5px;font-family:Arial,Helvetica,sans-serif;color:#faebd7;border:1px solid grey}#document-result *{background-color:unset;width:unset;text-align:unset;border-radius:unset;margin-left:unset;margin-right:unset;width:unset;padding-bottom:unset;align-items:unset;border-radius:unset;margin:unset;padding:unset}#document-result{overflow-wrap:break-word;min-height:100px;width:auto;background-color:#fafad2;white-space:pre-wrap}main{border:1px solid grey}#back-nav{display:none}@media only screen and (min-width:600px){#back-nav,#main-calendar-table,#main-contacts-table,#main-notes,#main-tables-table,#main-write,#top-nav,body,h1:not(#document-resulth1){width:600px}#contacts-table td,#contacts-table th{display:table-cell}}@media only screen and (min-width:900px){#back-nav,#main-calendar-table,#main-contacts-table,#main-notes,#main-tables-table,#main-write,#top-nav,body,h1:not(#document-resulth1){width:900px}}
    </style>
</head>

<body>
    <h1>bitOffice</h1>
    <nav id="top-nav">
        <button onclick="showMain('main-startup');">&#128194;</button>
        <button onclick="showMain('main-contacts-table'); processGoToApp('contacts');">&#9742;</button>
        <button onclick="showMain('main-calendar-start'); processGoToApp('calendar');">&#128197;</button>
        <button onclick="showMain('main-notes'); processGoToApp('notes');">&#128221;</button>
        <button onclick="showMain('main-write'); processGoToApp('write');">&#128196;</button>
        <button onclick="showMain('main-tables-table'); processGoToApp('tables')">&#9638;</button>

        <button onclick="showMain('main-calculator');processGoToApp('calculator')">&#128290;</button>

        <button onclick="showMain('main-help');">?</button>
    </nav>
    <nav id="back-nav">
        <button onclick="processGoBackFromApp(currentApp);">&#127968;</button>
    </nav>

    <main id="main-startup">
        <h2>Personal Database</h2>
        <button onclick="loadCombinedDatabase()">&#128194; Load</button>
        <button id="saveButton" onclick="saveCombinedDatabase()">&#128193; Save</button>
    </main>
    <main id="main-help">
        <h2>Help</h2>
        <pre>
            <h3>bitOffice64</h3><br> Here is a super small file that weighs in under 64kb and runs on any device with a modern browser.<br>
            <br> It contains:<br> • A personal database with:<br> - Contacts<br> - A Planner<br> • A notes text editor<br> • A word processor<br> • A CSV spreadsheet editor<br> • A calculator.
            <br><br>
            No special server software needs to be installed an there is no installation.  If you an html5 browser, just open this file and you're good to go!
        </pre>
        <p>Check out the project at: <a target="_blank" href="https://github.com/garydavenport73/bitOffice">bitOffice64.</a></p>
        <p>...and other projects at: <a target="_blank" href="https://github.com/garydavenport73">my GitHub Site.</a></p>
    </main>
    <main id="main-notes">
        <h2>Notes</h2>
        <nav>
            <button onclick="newNotesEntry()">New</button>
            <button onclick="notesLoad()">Load</button>
            <button onclick="notesSave()">Save</button>
            <button id="copy" onclick="copyToClipBoard(document.getElementById('note').value);">Copy</button>
            <button onclick="printNotesDiv('note');">&#128424;</button>
            <button class="plus-minus" onclick="changeFontSize(this);">-</button>
            <button class="plus-minus" onclick="changeFontSize(this);">+</button>
            <button onclick="simulateUndo()">&#10226;</button>
        </nav>
        <textarea id="note" rows="10" placeholder="your notes here"></textarea>
    </main>
    <main id="main-write">
        <h2>Write</h2>
        <nav id="file-bar">
            <button onclick="newDocument();">New</button>
            <button onclick="writeLoad();">Load</button>
            <button onclick="writeDataToJSON();">Save</button>
            <button onclick="exportToHTML()">Export</button>
            <button onclick="printWriteDiv('document-parent');//window.print()">&#128424;</button>
        </nav>
        <nav id="document-settings">
            <button class="mono" onclick='processSelectedText(this);'>Mono</button>
            <button class="serif" onclick='processSelectedText(this);'>Serif</button>
            <button class="sans" onclick='processSelectedText(this);'>Sans</button>
            <button onclick='processSelectedText(this);//decrease font'><sup>A</sup>A</button>
            <button onclick='processSelectedText(this);//increase font;'><sub>A</sub>A</button>
            <button onclick='processSelectedText(this);//inc margin;'>&rarrb;&larrb;</button>
            <button onclick='processSelectedText(this);//dec margin;'>&larrb;&rarrb;</button>
            <button onclick='processSelectedText(this);//align left;'>&#8666;</button>
            <button onclick='processSelectedText(this);//align center;'>&#8667;&#8666;</button>
            <button onclick='processSelectedText(this);//align right;'>&#8667;</button>
            <button id="spell-check" onclick='processSelectedText(this);//spellcheck;'>&check;</button>
        </nav>
        <nav id="edit-bar">
            <button onclick='processSelectedText(this);'><b>B</b></button>
            <button onclick='processSelectedText(this);'><u>U</u></button>
            <button onclick='processSelectedText(this);'><em>I</em></button> &nbsp;
            <button onclick='processSelectedText(this);//paragraph;'>&para;</button>
            <button onclick='processSelectedText(this);'>H1</button>
            <button onclick='processSelectedText(this);'>H2</button>
            <button onclick='processSelectedText(this);'>H3</button> &nbsp;
            <button onclick='processSelectedText(this);//horizontal rule'>&#8213;</button>
            <button onclick='processSelectedText(this);//bullet;'>&bullet;</button> &nbsp;
            <button onclick='processSelectedText(this);//undo;'>&#10226;</button>
        </nav>
        <textarea id="text-editor" spellcheck="false" oninput="writeUpdateResult();"></textarea>
        <div id="document-parent">
            <div id="document-result"></div>
        </div>
    </main>
    <main id="main-tables-table">
        <h2>Tables</h2>
        <nav>
            <button onclick="tablesNewTable();">New</button>
            <button onclick="tablesLoad();">Load</button>
            <button onclick="tablesSave();">Save</button>
            <button onclick="tablesCopyCSVToClipboard()">Copy</button>
            <button onclick="tablesShowRules();">?</button>
        </nav>
        <div class="table-container">
            <table id="tables-table">
            </table>
        </div>
    </main>
    <main id="main-tables-header-form">
        </h2>Tables</h2>
        <h3>Column: <span id="tables-current-header">header name here</span></h3>
        <button onclick="updateHeaderName(tablesTable);">Change name to:</button>
        <input id="tables-new-header-name" type="text" placeholder="name">
        <button onclick="deleteColumn(tablesTable);">Delete Column</button>
        <button onclick="copyColumn(tablesTable)">Copy Column</button>
        <button onclick="moveColumn(tablesTable)">Move To Column</button><select id="move-column"></select>
        <button onclick="calculateTotal(tablesTable)">Add Total</button>
        <button onclick="calculateAverage(tablesTable)">Compute Average</button>
        <button onclick="tablesCancel(tablesTable)">Cancel</button>
    </main>
    <main id="main-tables-row-form">
        <h2>Tables</h2>
        <h3>Row: <span id="tables-current-row">row number here</span></h3>
        <button onclick="deleteRow()">Delete Row</button>
        <button onclick="copyRow()">Copy Row</button>
        <button onclick="moveRow()">Move To Row</button>
        <select id="move-row"></select>
        <button onclick="tablesCancel(tablesTable)">Cancel</button>
    </main>
    <main id="main-contacts-table">
        <h2 id="contacts-table-name">Contacts</h2>
        <nav>
            <button onclick='newContactsEntry(contactsTable);'>+ New Contact</button>
            <button onclick="processCSVClick(contactsTable);">CSV</button>
        </nav>

        <div id="contacts-table" class="table-container"></div>
    </main>
    <main id="main-contacts-form">
        <h2>Contacts</h2>
        <div id="contacts-edit-form-message"></div>
        <div id="contacts-edit-form"></div>
        <button onclick='saveContactsEntry(contactsTable);'>Save</button>
        <button onclick='deleteContactsEntry(contactsTable);'>Delete</button>
        <button onclick='cancelContactsEntry(contactsTable);'>Cancel</button>
    </main>
    <main id="main-calendar-start">
        <h2>Calendar</h2>

        <div>
            <input type='date' id="calendar-date">
        </div>
        <button onclick="processOpenCalendar();">Open</button>
    </main>
    <main id="main-calendar-table">
        <h2>Calendar</h2>
        <h3 id="calendar-table-name"></h3>
        <nav>
            <button onclick='newCalendarEntry();'>+ New Entry</button>
            <button onclick="processCalendarCSVClick();">CSV</button>
        </nav>
        <div id="calendar-table" class="table-container"></div>
    </main>
    <main id="main-calendar-form">
        <h2>Calendar</h2>
        <h3 id="calendar-edit-form-message"></h3>
        <div id="calendar-edit-form"></div>
        <button onclick='saveCalendarEntry();'>Save</button>
        <button onclick='deleteCalendarEntry();'>Delete</button>
        <button onclick='cancelCalendarEntry();'>Cancel</button>
    </main>
    <main id="main-calculator">
        <h2>Calculator</h2>
        <div id="calculator-result-row"><input type=text id='calculator-input'>
            <button onclick=buildCalcString(this)>&larr;</button>
            <span class="filler"></span>
            <button onclick=buildCalcString(this) class="special-calculator-button">CLR</button>
        </div>
        <span id="expression-span"></span>
        <table id="calculator-table">
            <tr>
                <td><button onclick=buildCalcString(this)>7</button></td>
                <td><button onclick=buildCalcString(this)>8</button></td>
                <td><button onclick=buildCalcString(this)>9</button></td>
                <td><button onclick=buildCalcString(this)>/</button></td>
            </tr>
            <tr>
                <td><button onclick=buildCalcString(this)>4</button></td>
                <td><button onclick=buildCalcString(this)>5</button></td>
                <td><button onclick=buildCalcString(this)>6</button></td>
                <td><button onclick=buildCalcString(this)>x</button></td>
            </tr>
            <tr>
                <td><button onclick=buildCalcString(this)>1</button></td>
                <td><button onclick=buildCalcString(this)>2</button></td>
                <td><button onclick=buildCalcString(this)>3</button></td>
                <td><button onclick=buildCalcString(this)>-</button></td>
            </tr>
            <tr>
                <td><button onclick=buildCalcString(this)>0</button></td>
                <td><button onclick=buildCalcString(this)>.</button></td>
                <td><button id="equals-button" class="special-calculator-button" onclick=buildCalcString(this)>=</button></td>
                <td><button onclick=buildCalcString(this)>+</button></td>
            </tr>
        </table>
    </main>
    <script>let calcString="",calculatorInput=document.getElementById("calculator-input"),charToAdd="",expressionSpan=document.getElementById("expression-span"),tableElement=document.getElementById("tables-table"),tablesSortAscending=1,tablesTable={name:"Table",headers:["Column 1","Column 2","Column 3"],data:[{"Column 1":"","Column 2":"","Column 3":""},{"Column 1":"","Column 2":"","Column 3":""},{"Column 1":"","Column 2":"","Column 3":""}]},compareTablesTable=JSON.stringify(tablesTable),initialTablesTable=compareTablesTable,contactsTableElement=document.getElementById("contacts-table"),contactsEditForm=document.getElementById("contacts-edit-form"),contactsEditFormMessage=document.getElementById("contacts-edit-form-message"),contactsTable={name:"Contacts",headers:["name","cell","email","address","home","work","website"],inputTypes:{name:"text",cell:"tel",email:"email",address:"text",home:"tel",work:"tel",website:"text"},data:[{name:"John",cell:"316-123-1234",email:"john@junkmail.com",address:"3160 Patmos Dr., Eden, WV  12345"}]},noteFontSize=2.5/3,note=document.getElementById("note");note.value="";let compareNoteValue="",writeBaseFilename="",textarea=document.getElementById("text-editor"),documentDiv=document.getElementById("document-result"),remSize=1,marginSize=2,writeUndos=[],compareWriteData="",calendarTable=document.getElementById("calendar-table"),calendarEditForm=document.getElementById("calendar-edit-form"),calendarEditFormMessage=document.getElementById("calendar-edit-form-message"),calendarDatabase={name:"Calendar",headers:["start","end","name","notes"],inputTypes:{start:"time",end:"time",name:"text",notes:"text"},dates:{}},combinedDatabase={contacts:contactsTable,calendar:calendarDatabase},compareCombinedDatabase=JSON.stringify(combinedDatabase),initialCombinedDatabase=compareCombinedDatabase,currentApp="";</script>
    <script>function loadCombinedDatabase(){let proceed=!1;if(proceed=compareCombinedDatabase===initialCombinedDatabase||confirm("This will overwrite current personal database"),proceed){let fileContents="",inputTypeIsFile=document.createElement("input");inputTypeIsFile.type="file",inputTypeIsFile.accept=".bof",inputTypeIsFile.addEventListener("change",(function(){let inputFile=inputTypeIsFile.files[0],fileReader=new FileReader;fileReader.onload=function(fileLoadedEvent){fileContents=fileLoadedEvent.target.result,combinedDatabase=JSON.parse(fileContents),compareCombinedDatabase=JSON.stringify(combinedDatabase),contactsTable=combinedDatabase.contacts,calendarDatabase=combinedDatabase.calendar,clearContactFormEntries(contactsTable),contactsTableElement.innerHTML=buildContactsTableElement(contactsTable)},fileReader.readAsText(inputFile,"UTF-8")})),inputTypeIsFile.click()}}function saveCombinedDatabase(){let str,baseFilename;purgeCalendar(),saveStringToTextFile(JSON.stringify(combinedDatabase),"bitOfficeProfile"+getTodaysDate(),".bof"),compareCombinedDatabase=JSON.stringify(combinedDatabase)}function setColorOfBackupSaveButton(){console.log("called set color of backup button"),compareCombinedDatabase===JSON.stringify(combinedDatabase)?document.getElementById("saveButton").style.backgroundColor="unset":document.getElementById("saveButton").style.backgroundColor="orange"}function processGoToApp(theApp){"contacts"!==theApp&&"calendar"!==theApp||(compareCombinedDatabase=JSON.stringify(combinedDatabase)),"tables"===theApp&&(compareTablesTable=JSON.stringify(tablesTable)),"notes"===theApp&&(compareNoteValue=note.value),"write"===theApp&&(compareWriteData=makeCompareWriteData()),currentApp=theApp,document.getElementById("top-nav").style.display="none",document.getElementById("back-nav").style.display="flex"}function processGoBackFromApp(currentApp){console.log("process check save for "+currentApp),"contacts"!==currentApp&&"calendar"!==currentApp||(JSON.stringify(combinedDatabase)===compareCombinedDatabase?console.log("check not needed, nothing's changed"):(console.log("ask about saving the database, it has changed."),confirm("The database has change, save the changes to a file?")&&(saveCombinedDatabase(),compareCombinedDatabase=JSON.stringify(combinedDatabase)))),"tables"===currentApp&&(updateDataFromCurrentInputs(tablesTable),JSON.stringify(tablesTable)===compareTablesTable?console.log("in tables, check not needed, nothing's changed"):(console.log("need to ask about saving the table"),confirm("The table has change, save the changes to a file?")&&(tablesSave(),compareTablesTable=JSON.stringify(tablesTable)))),"notes"===currentApp&&(note.value===compareNoteValue?console.log("in notes, check not needed, nothing's changed"):(console.log("need to ask about saving the note"),confirm("The note has changed, save the changes to a file?")&&(notesSave(),compareNoteValue=note.value))),"write"===currentApp&&(compareWriteData===makeCompareWriteData()?console.log("in write, check not needed, nothing's changed"):(console.log("need to ask about saving write document"),confirm("The document has changed, save the changes to a file?")&&(writeDataToJSON(),compareWriteData=makeCompareWriteData()))),document.getElementById("top-nav").style.display="flex",document.getElementById("back-nav").style.display="none",showMain("main-startup")}function saveStringToTextFile(str1,basename="myfile",fileType=".txt"){let filename=basename+fileType,blobVersionOfText=new Blob([str1],{type:"text/plain"}),urlToBlob=window.URL.createObjectURL(blobVersionOfText),downloadLink=document.createElement("a");downloadLink.style.display="none",downloadLink.download=filename,downloadLink.href=urlToBlob,document.body.appendChild(downloadLink),downloadLink.click(),downloadLink.parentElement.removeChild(downloadLink)}function getTodaysDate(){let now=new Date,day=("0"+now.getDate()).slice(-2),month=("0"+(now.getMonth()+1)).slice(-2),today;return now.getFullYear()+"-"+month+"-"+day}function getFirstDayOfThisMonthDate(){let now=new Date,day="01",month=("0"+(now.getMonth()+1)).slice(-2);return now.getFullYear()+"-"+month+"-"+day}function getLastDayOfThisMonthDate(){let now=new Date,day=daysInThisMonth().toString();day="0"+day,day=day.slice(-2);let month=("0"+(now.getMonth()+1)).slice(-2);return now.getFullYear()+"-"+month+"-"+day}function daysInSomeMonth(someMonth,someYear){return new Date(someYear,someMonth+1,0).getDate()}function daysInThisMonth(){return thisDate=new Date,thisMonth=thisDate.getMonth(),thisYear=thisDate.getYear(),daysInSomeMonth(thisMonth,thisYear)}function serializeElementToPage(id,extraStyle=""){let boilerPlate1="<!DOCTYPE html><html lang='en'><head><meta charset='UTF-8'><meta http-equiv='X-UA-Compatible' content='IE=edge'><meta name='viewport' content='width=device-width, initial-scale=1.0'><title></title><style>",allStyleTags=document.getElementsByTagName("style"),styleElementContent="";for(let i=0;i<allStyleTags.length;i++)styleElementContent=allStyleTags[i].innerHTML;let boilerPlate2="</style></head><body>",boilerPlate3="</body></html>",s=new XMLSerializer,myElement=document.getElementById(id),str,htmlPage=boilerPlate1+styleElementContent+extraStyle+boilerPlate2+s.serializeToString(myElement)+boilerPlate3;return console.log(htmlPage),htmlPage}function simulateUndo(){document.execCommand("undo",!1,null)}function askConfirm(){return"Did you remember to save your data?"}function showMain(id){console.log("show mains called with "+id);let mains=document.getElementsByTagName("main");for(let main of mains)main.style.display="none";document.getElementById(id).style.display="flex"}function getCurrentDisplayedMain(){let mains=document.getElementsByTagName("main");for(let main of mains)if(console.log(main.id),"none"!=main.style.display)return main.id}function copyToClipBoard(str){let el=document.createElement("textarea");return el.value=str,el.setAttribute("readonly",""),el.style={position:"absolute",left:"-9999px"},document.body.appendChild(el),el.select(),document.execCommand("copy"),document.body.removeChild(el),alert("Copied to Clipboard."),str}function fillInEmptyPropertyValues(table){let data=table.data,headers=table.headers;for(let i=0;i<data.length;i++)for(let j=0;j<headers.length;j++)void 0===data[i][headers[j]]&&(data[i][headers[j]]="")}function makeCSV(thisTable,saveWithHeader=!0){let csvString="",tempString="",headers=thisTable.headers;if(!0===saveWithHeader){for(let header of headers)tempString=header.toString().replaceAll('"','""'),csvString+='"'+tempString+'",';csvString=csvString.slice(0,-1)+"\n"}let bodyData=thisTable.data,numberOfRows=bodyData.length,numberOfColumns=headers.length;for(let i=0;i<numberOfRows;i++){for(let j=0;j<numberOfColumns;j++)tempString=bodyData[i][headers[j]].toString().replaceAll('"','""'),csvString+='"'+tempString+'",';csvString=csvString.slice(0,-1)+"\n"}return console.log(csvString),csvString}function readCSV(csvString,loadWithHeader=!0){let lines=(csvString=csvString.trim()).split("\n"),newCSVArrayOfArrays=[];for(let i=0;i<lines.length;i++){lines[i]=lines[i].trim(),lines[i]=lines[i].slice(1,-1);let tempRowArray=lines[i].split('","'),randomString=tokenMaker(32);for(;!0===lines[i].includes(randomString);)randomString=tokenMaker(32);let newString=tempRowArray.join(randomString);newString=newString.replaceAll('"'+randomString+'"','","'),tempRowArray=newString.split(randomString);for(let j=0;j<tempRowArray.length;j++)tempRowArray[j]=tempRowArray[j].replaceAll('""','"');newCSVArrayOfArrays.push(tempRowArray)}console.log(newCSVArrayOfArrays);let headers=[],data=[];if(newCSVArrayOfArrays.length>0)if(!0===loadWithHeader){if(headers=newCSVArrayOfArrays[0],newCSVArrayOfArrays.length>1)for(let i=1;i<newCSVArrayOfArrays.length;i++){let tempRow={};for(let j=0;j<newCSVArrayOfArrays[i].length;j++)tempRow[headers[j]]=newCSVArrayOfArrays[i][j];data.push(tempRow)}}else if(newCSVArrayOfArrays.length>0){for(let j=0;j<newCSVArrayOfArrays[0].length;j++)headers.push("Column "+(j+1).toString());for(let i=0;i<newCSVArrayOfArrays.length;i++){let tempRow={};for(let j=0;j<newCSVArrayOfArrays[i].length;j++)tempRow[headers[j]]=newCSVArrayOfArrays[i][j];data.push(tempRow)}}console.log(headers),console.log(data);let finalTable={};return finalTable.headers=headers,finalTable.data=data,JSON.parse(JSON.stringify(finalTable))}function tokenMaker(intSize){let token="",specialString="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",index=0;for(let i=0;i<intSize;i++)token+=specialString[Math.floor(Math.random()*specialString.length)];return console.log(token),token}function processCSVClick(table){let thisCSV="";thisCSV=confirm("Include header as first line in csv file?")?makeCSV(table,!0):makeCSV(table,!1),copyToClipBoard(thisCSV),confirm("Table copied to CSV.\n\nSave to file also?")&&saveStringToTextFile(thisCSV,table.name+getTodaysDate(),".csv")}function destructiveSort(arrayOfObjects,field,direction=1){-1!=direction&&(direction=1),arrayOfObjects.sort((a,b)=>a[field]<b[field]?-1*direction:a[field]>b[field]?1*direction:0)}</script>
    <script>function initializeNotesApp(){note.style.fontSize=noteFontSize.toString()+"rem",note.spellcheck=!1,note.focus()}function changeFontSize(fontButton){let doThis;"-"===fontButton.innerHTML?noteFontSize>.2&&(noteFontSize-=.2):noteFontSize+=.2,note.style.fontSize=noteFontSize.toString()+"rem"}function newNotesEntry(){""!=note.value&&confirm("This will erase current contents.")&&(note.value="",compareNoteValue="")}function notesLoad(){let fileContents="",inputTypeIsFile=document.createElement("input");inputTypeIsFile.type="file",inputTypeIsFile.accept=".txt",inputTypeIsFile.addEventListener("change",(function(){let inputFile=inputTypeIsFile.files[0],fileReader=new FileReader;fileReader.onload=function(fileLoadedEvent){fileContents=fileLoadedEvent.target.result,note.value=fileContents},fileReader.readAsText(inputFile,"UTF-8")})),inputTypeIsFile.click()}function notesSave(){basename="notes"+getTodaysDate(),saveStringToTextFile(note.value,basename,".txt"),compareNoteValue=note.value}function printNotesDiv(id){let a=window.open();a.document.write(serializeNotesElementToPage(id,"html{background-color:white;}#note{font-size:"+noteFontSize+"rem}")),a.document.close(),a.print()}function serializeNotesElementToPage(id,extraStyle=""){let boilerPlate1="<!DOCTYPE html><html lang='en'><head><meta charset='UTF-8'><meta http-equiv='X-UA-Compatible' content='IE=edge'><meta name='viewport' content='width=device-width, initial-scale=1.0'><title></title><style>",allStyleTags=document.getElementsByTagName("style"),styleElementContent="";for(let i=0;i<allStyleTags.length;i++)styleElementContent=allStyleTags[i].innerHTML;let boilerPlate2,boilerPlate3="</body></html>",str,htmlPage=boilerPlate1+styleElementContent+extraStyle+"</style></head><body>"+("<pre id='note'>"+document.getElementById(id).value+"</pre>")+boilerPlate3;return console.log(htmlPage),htmlPage}initializeNotesApp();</script>
    <script>function initializeWriteApp(){documentDiv.style.fontSize=remSize+"rem",documentDiv.style.marginLeft=marginSize+"rem",documentDiv.style.marginRight=marginSize+"rem",writeUndos.push(textarea.value),writeUpdateResult(),textarea.spellcheck=!1,textarea.focus(),document.getElementById("text-editor").addEventListener("keydown",(function(e){if("Tab"==e.key){e.preventDefault();let start=this.selectionStart,end=this.selectionEnd;this.value=this.value.substring(0,start)+"\t"+this.value.substring(end),this.selectionStart=this.selectionEnd=start+1,writeUpdateResult()}})),compareWriteData=makeCompareWriteData()}function exportToHTML(){let contents=serializeElementToPage("document-parent","html,#document-result,#document-parent{background-color:white;}");copyToClipBoard(contents),confirm("HTML document exported to clipboard.\n\nWould you like to export to HTML file?")&&saveStringToTextFile(contents,"write"+getTodaysDate(),".html")}function newDocument(){confirm("This will overwrite current document.")&&writeResetAll()}function writeResetAll(){writeBaseFilename="",remSize=1,marginSize=2,textarea.value="",documentDiv.style.textAlign="left",documentDiv.style.fontFamily="Georgia, 'Times New Roman', Garamond, Times, serif",documentDiv.style.fontSize="1rem",documentDiv.style.marginLeft="2rem",textarea.spellcheck=!1,writeUndos=[],writeUndos.push(textarea.value),writeUpdateResult(),textarea.focus()}function makeCompareWriteData(){writeUpdateResult();let data={};return data.text=textarea.value,data.textAlign=documentDiv.style.textAlign,data.fontFamily=documentDiv.style.fontFamily,data.fontSize=documentDiv.style.fontSize,data.marginSize=documentDiv.style.marginLeft,data.spellCheck=textarea.spellcheck,JSON.stringify(data)}function writeDataToJSON(){writeUpdateResult();let data={};data.text=textarea.value,data.textAlign=documentDiv.style.textAlign,data.fontFamily=documentDiv.style.fontFamily,data.fontSize=documentDiv.style.fontSize,data.marginSize=documentDiv.style.marginLeft,data.spellCheck=textarea.spellcheck,writeBaseFilename="write"+getTodaysDate();let saveContents=JSON.stringify(data);saveStringToTextFile(saveContents,writeBaseFilename,".json"),compareWriteData=makeCompareWriteData()}function writeLoad(){console.log("writeLoad() called"),console.log(textarea.value),console.log(textarea.value.length);let proceed=!0;if(0!=textarea.value.length&&(proceed=confirm("This will overwrite current document")),proceed){let fileContents="",inputTypeIsFile=document.createElement("input");inputTypeIsFile.type="file",inputTypeIsFile.accept=".json",inputTypeIsFile.addEventListener("change",(function(){let inputFile=inputTypeIsFile.files[0],fileReader=new FileReader;fileReader.onload=function(fileLoadedEvent){fileContents=fileLoadedEvent.target.result;let loadedData=JSON.parse(fileContents);textarea.value=loadedData.text,documentDiv.style.textAlign=loadedData.textAlign,documentDiv.style.fontFamily=loadedData.fontFamily,documentDiv.style.fontSize=loadedData.fontSize,documentDiv.style.marginLeft=loadedData.marginSize,textarea.spellcheck=loadedData.spellCheck,writeUpdateResult(),remSize=parseFloat(loadedData.fontSize.split("rem")[0]),marginSize=parseFloat(loadedData.marginSize.split("rem")[0]),writeUndos=[],console.log("writeUndos length",writeUndos.length),writeUndos.push(textarea.value),textarea.focus()},fileReader.readAsText(inputFile,"UTF-8")})),inputTypeIsFile.click()}}function processSelectedText(clickedElement){let action=clickedElement.innerHTML;if(console.log(action),"⟲"!=action&&(writeUndos.length>=316?(writeUndos.shift(),writeUndos.push(textarea.value)):writeUndos.push(textarea.value)),"⇚"===action)documentDiv.style.textAlign="left";else if("⇛⇚"===action)documentDiv.style.textAlign="center";else if("⇛"===action)documentDiv.style.textAlign="right";else if("Mono"===action)documentDiv.style.fontFamily="'Courier New', Courier, monospace";else if("Serif"===action)documentDiv.style.fontFamily="Georgia, 'Times New Roman', Garamond, Times, serif";else if("Sans"===action)documentDiv.style.fontFamily="Arial, Verdana, Helvetica, Tahoma, sans-serif";else if("<sub>A</sub>A"===action)remSize+=.2,documentDiv.style.fontSize=remSize.toString()+"rem";else if("<sup>A</sup>A"===action)remSize-=.2,documentDiv.style.fontSize=remSize.toString()+"rem";else if("⇥⇤"===action)marginSize+=1,marginSize>20&&(marginSize=20),documentDiv.style.marginLeft=marginSize.toString()+"rem",documentDiv.style.marginRight=marginSize.toString()+"rem";else if("⇤⇥"===action)marginSize-=1,marginSize<0&&(marginSize=0),documentDiv.style.marginLeft=marginSize.toString()+"rem",documentDiv.style.marginRight=marginSize.toString()+"rem";else if("⟲"===action)if(console.log(writeUndos),writeUndos.length>1){let thisText=writeUndos.pop();textarea.value=thisText,writeUpdateResult()}else 1===writeUndos.length?(textarea.value=writeUndos[0],writeUpdateResult()):0===writeUndos.length&&(textarea.value="",writeUpdateResult());else"✓"===action&&(console.log(textarea.spellcheck),textarea.spellcheck=!textarea.spellcheck,console.log(textarea.spellcheck),textarea.focus());let len=textarea.value.length,start=textarea.selectionStart,end=textarea.selectionEnd,sel=textarea.value.substring(start,end),replace=sel;"<b>B</b>"===action?replace="<b>"+sel+"</b>":"<u>U</u>"===action?replace="<u>"+sel+"</u>":"<em>I</em>"===action?replace="<em>"+sel+"</em>":"H1"===action?replace="<h1>"+sel+"</h1>":"H2"===action?replace="<h2>"+sel+"</h2>":"H3"===action?replace="<h3>"+sel+"</h3>":"¶"===action?replace="<p>"+sel+"</p>":"―"===action?replace="<hr>"+sel:"•"===action&&(replace="&bullet; "+sel),textarea.value=textarea.value.substring(0,start)+replace+textarea.value.substring(end,len),writeUpdateResult()}function writeUpdateResult(){let currentContents=document.getElementById("text-editor").value;console.dir(document.getElementById("text-editor")),document.getElementById("document-result").innerHTML=currentContents.replaceAll("\n","<br>"),!0===textarea.spellcheck?document.getElementById("spell-check").style.color="green":document.getElementById("spell-check").style.color="red"}function printWriteDiv(id){let a=window.open();a.document.write(serializeElementToPage(id,"html,#document-result,#document-parent{background-color:white;}")),a.document.close(),a.print()}initializeWriteApp();</script>
    <script>function initializeTablesApp(){makeTable(tablesTable)}function backupTablesTable(){return updateDataFromCurrentInputs(tablesTable),JSON.parse(JSON.stringify(currentTablesTable))}function processColumnClick(header){updateDataFromCurrentInputs(tablesTable),populateMoveColumnSelect(tablesTable),document.getElementById("tables-current-header").innerHTML=header,document.getElementById("tables-new-header-name").value=header,showMain("main-tables-header-form")}function processRowClick(row){updateDataFromCurrentInputs(tablesTable),populateMoveRowSelect(tablesTable),document.getElementById("tables-current-row").innerHTML=row.toString(),showMain("main-tables-row-form")}function makeTable(table){let str="";str="";let headers=table.headers;str+="<thead><tr><th></th>";for(let i=0;i<headers.length;i++)str+="<th id='"+headers[i]+"' onclick=\"processColumnClick('"+headers[i]+"');\">"+headers[i]+"</th>";str+="<th id='add-column' onclick='addColumn(tablesTable)'>+</th>",str+="</tr></thead>";let tableHeader=str;str="<tbody>";let bodyData=table.data;console.log("bodyData"),console.log(bodyData);let rowCount=bodyData.length;for(let i=0;i<rowCount;i++){str+="<tr><td id='row-"+i.toString()+"' onclick='processRowClick("+i.toString()+")'>"+i.toString()+"</td>";let columnCount=headers.length;console.log(columnCount);for(let j=0;j<columnCount;j++)str+="<td><input type='text' id='cell-"+i.toString()+"-"+j.toString()+"' value='"+bodyData[i][headers[j]].toString()+"'></td>";str+="</tr>"}str+="</tbody>";let tableBody=str;str="<tfoot><tr><th id='add-row' onclick='addRow(tablesTable)'>+</th>";for(let i=0;i<headers.length;i++)str+="<th id='footer-"+(i+1).toString()+"' onclick=\"processColumnClick('"+headers[i]+"');\"></th>";str+="</tr></tfoot>";let tableFooter,strTable=tableHeader+tableBody+str;return populateMoveColumnSelect(table),populateMoveRowSelect(table),tableElement.innerHTML=strTable,strTable}function populateMoveColumnSelect(table){let moveColumnSelect=document.getElementById("move-column");moveColumnSelect.options.length=0;let currentTableHeaders=table.headers;for(th of currentTableHeaders){let option=document.createElement("option");option.value=th,option.text=th,moveColumnSelect.add(option)}}function populateMoveRowSelect(table){let moveRowSelect=document.getElementById("move-row");moveRowSelect.options.length=0;for(let i=0;i<table.data.length;i++){let option=document.createElement("option");option.value=i.toString(),option.text=i.toString(),moveRowSelect.add(option)}}function updateDataFromCurrentInputs(table){let headers=table.headers;console.log("headers"),console.log(headers);for(let i=0;i<table.data.length;i++)for(let j=0;j<table.headers.length;j++){let id="cell-"+i.toString()+"-"+j.toString(),thisCell=document.getElementById(id);table.data[i][headers[j]]=thisCell.value}}function updateHeaderName(table){let fieldName=document.getElementById("tables-current-header").innerHTML,newName=document.getElementById("tables-new-header-name").value;fieldName!==newName?""===newName&&(newName=prompt("There is no name listed, please enter the new name"),null===newName)||(makeTable(table=_changeHeaderAndDataPropertyName(table,newName,fieldName)),showMain("main-tables-table")):makeTable(table)}function _changeHeaderAndDataPropertyName(table,newName,oldName){let data=table.data;newName=getBestName(table,newName);let index=table.headers.indexOf(oldName);table.headers[index]=newName;for(let i=0;i<data.length;i++)data[i][newName]=data[i][oldName],delete data[i][oldName];return table}function deleteColumn(table){let columnName=document.getElementById("tables-current-header").innerHTML,index=table.headers.indexOf(columnName);table.headers.splice(index,1);for(let i=0;i<table.data.length;i++)delete table.data[i][columnName];makeTable(table),showMain("main-tables-table")}function addColumn(table){updateDataFromCurrentInputs(table);let newIndex=1,newColumnName="new"+newIndex.toString();for(;table.headers.includes(newColumnName);)console.log("column name already in use"),newIndex+=1,newColumnName="new"+newIndex.toString();table.headers.push(newColumnName),fillInEmptyPropertyValues(table),makeTable(table)}function moveColumn(table){let columnName=document.getElementById("tables-current-header").innerHTML,destinationColumnName=document.getElementById("move-column").value;if(columnName===destinationColumnName)return void console.log("destination is same as source");let index=table.headers.indexOf(columnName),destinationIndex=table.headers.indexOf(destinationColumnName),headerToMove=table.headers.splice(index,1)[0];table.headers.splice(destinationIndex,0,headerToMove),makeTable(table),showMain("main-tables-table")}function getBestName(table,name){let headers=table.headers,nameCount=0,bestName=name;for(;headers.includes(bestName);)console.log("column name already in use"),nameCount+=1,bestName=name+"-"+nameCount.toString();return bestName}function copyColumn(table){let columnName=document.getElementById("tables-current-header").innerHTML,newName=getBestName(table,columnName);table.headers.push(newName);for(let i=0;i<table.data.length;i++)table.data[i][newName]=table.data[i][columnName];makeTable(table),showMain("main-tables-table")}function calculateTotal(table){let columnName=document.getElementById("tables-current-header").innerHTML,total=0;for(let row of table.data)total+=Number(row[columnName]);confirm("The total is: "+total.toString()+"\nCopy to clipboard?")&&copyToClipBoard(total.toString()),showMain("main-tables-table")}function tablesCancel(table){console.log("tablesCancel called"),makeTable(table),showMain("main-tables-table")}function calculateAverage(){alert("calculate average called"),console.log("calcualtoe average called");let columnName=document.getElementById("tables-current-header").innerHTML,total=0;for(let row of table.data)total+=Number(row[columnName]);let average=total/table.data.length;confirm("The average is: "+average.toString()+"\nCopy to clipboard?")&&copyToClipBoard(average.toString()),showMain("main-tables-table")}function addRow(table){let headers=table.headers;updateDataFromCurrentInputs(table);let numberOfColumns=table.headers.length,tempRow={};for(let i=0;i<numberOfColumns;i++)tempRow[headers[i]]="";table.data.push(tempRow),makeTable(table)}function deleteRow(){let index=parseInt(document.getElementById("tables-current-row").innerHTML),data;table.data.splice(index,1),makeTable(table),showMain("main-tables-table")}function copyRow(){console.log("copy row called");let index=parseInt(document.getElementById("tables-current-row").innerHTML),data=table.data;console.log(data);let rowToCopy=JSON.parse(JSON.stringify(table.data[index]));data.push(rowToCopy),makeTable(table),showMain("main-tables-table")}function moveRow(){console.log("move row called");let index=parseInt(document.getElementById("tables-current-row").innerHTML),data=tablesTable.data,destinationIndex=parseInt(document.getElementById("move-row").value),rowToMove=data.splice(index,1)[0];data.splice(destinationIndex,0,rowToMove),makeTable(tablesTable),showMain("main-tables-table")}function tablesNewTable(){if(confirm("Are you sure?  This will erase all current data."))return tablesTable=JSON.parse(initialTablesTable),compareTablesTable=initialTablesTable,makeTable(tablesTable),showMain("main-tables-table"),tablesTable}function tablesLoad(){console.log("tablesLoad() called");let fileContents="",inputTypeIsFile=document.createElement("input");inputTypeIsFile.type="file",inputTypeIsFile.accept=".csv",inputTypeIsFile.addEventListener("change",(function(){let inputFile=inputTypeIsFile.files[0],fileReader=new FileReader;fileReader.onload=function(fileLoadedEvent){fileContents=fileLoadedEvent.target.result,confirm("Use the first line as the header row?")?tablesTable=readCSV(fileContents,!0):tablesTable=readCSV(fileContents,!1),makeTable(tablesTable),compareTablesTable=JSON.stringify(tablesTable)},fileReader.readAsText(inputFile,"UTF-8")})),inputTypeIsFile.click()}function tablesSave(){console.log("tablesSave() called"),updateDataFromCurrentInputs(tablesTable),confirm("Include header as first line in csv file?")?saveStringToTextFile(makeCSV(tablesTable,!0),"csvTable"+getTodaysDate(),".csv"):saveStringToTextFile(makeCSV(tablesTable,!1),"csvTable"+getTodaysDate(),".csv"),compareTablesTable=JSON.stringify(tablesTable)}function tablesShowRules(){alert('FORMATTING RULES:\n\nWhen Saving:\n1) All cells are quoted text.\n2) Interior double quotes in cells are converted like this: "->""\n\nIf loading CSV from other apps:\n1) Cells should all be text type.\n2) Quote all text strings when saving.')}function tablesCopyCSVToClipboard(){updateDataFromCurrentInputs(tablesTable);let thisResult="";return thisResult=confirm("Include header as first line?")?copyToClipBoard(makeCSV(tablesTable,!0)):copyToClipBoard(makeCSV(tablesTable,!1)),thisResult}initializeTablesApp();</script>
    <script>function initializeContactsApp(){fillInEmptyPropertyValues(contactsTable),document.getElementById("contacts-table-name").innerHTML=contactsTable.name,contactsTableElement.innerHTML=buildContactsTableElement(contactsTable),contactsEditForm.innerHTML=buildContactsEditForm(contactsTable,-1)}function backupContactsDatabase(){return JSON.parse(JSON.stringify(contactsTable))}function buildContactsTableElement(contactsTable){let tableElement="",numberOfColumns=contactsTable.headers.length,numberOfRows=contactsTable.data.length;tableElement+="<table>",tableElement+="<thead><tr>";for(let j=0;j<numberOfColumns;j++)tableElement+="<th onclick='sortContactsByField(this);'>"+contactsTable.headers[j]+"</th>";tableElement+="</tr></thead>",tableElement+="<tbody>";for(let i=0;i<numberOfRows;i++){tableElement+="<tr id='contacts-table-row-"+i.toString()+"' onclick='selectContactsEditForm(this)'>";for(let j=0;j<numberOfColumns;j++){let fieldName=contactsTable.headers[j];tableElement+="<td>"+contactsTable.data[i][fieldName]+"</td>"}tableElement+="</tr>"}return tableElement+="</tbody>",tableElement}function newContactsEntry(contactsTable){contactsEditFormMessage.innerHTML=contactsTable.name+": New Entry",contactsEditForm.innerHTML=buildContactsEditForm(contactsTable,-1),showMain("main-contacts-form")}function selectContactsEditForm(clickedRow){let index=parseInt(clickedRow.id.split("-")[3]);contactsEditFormMessage.innerHTML=contactsTable.name+": Entry "+index.toString(),contactsEditForm.innerHTML=buildContactsEditForm(contactsTable,index),showMain("main-contacts-form")}function buildContactsEditForm(contactsTable,index){let editForm="";editForm+="<form>",editForm="<input type='hidden' id='contacts-row-index' value='"+index.toString()+"'>";let numberOfColumns=contactsTable.headers.length,headers=contactsTable.headers,row=contactsTable.data[index],inputTypes=contactsTable.inputTypes;for(let j=0;j<numberOfColumns;j++){let extraString="";"number"===inputTypes[headers[j]]?extraString=" step='any' ":"tel"===inputTypes[headers[j]]&&(extraString=" placeholder='304-424-1000' pattern='[0-9]{3}-[0-9]{3}-[0-9]{4}' "),editForm+=-1===index?"<div><label for='contact-"+headers[j]+"'>"+headers[j]+"</label></div><div><input type='"+inputTypes[headers[j]]+"' id='contact-"+headers[j]+"' "+extraString+"></div>":"<div><label for='contact-"+headers[j]+"'>"+headers[j]+"</label></div><div><input type='"+inputTypes[headers[j]]+"' id='contact-"+headers[j]+"' value='"+row[headers[j]].replaceAll('"',"&quot;").replaceAll("'","&apos;")+"'"+extraString+"></div>"}return editForm+="</form>",editForm}function saveContactsEntry(contactsTable){let index=parseInt(document.getElementById("contacts-row-index").value),headers=contactsTable.headers,row={};for(let j=0;j<headers.length;j++)row[headers[j]]=document.getElementById("contact-"+headers[j]).value;index>=0?contactsTable.data[index]=row:contactsTable.data.push(row),clearContactFormEntries(contactsTable),contactsTableElement.innerHTML=buildContactsTableElement(contactsTable),showMain("main-contacts-table")}function deleteContactsEntry(contactsTable){let index=parseInt(document.getElementById("contacts-row-index").value);index>=0&&confirm("Delete this entry?")&&contactsTable.data.splice(index,1),clearContactFormEntries(contactsTable),contactsTableElement.innerHTML=buildContactsTableElement(contactsTable),showMain("main-contacts-table")}function cancelContactsEntry(contactsTable){clearContactFormEntries(contactsTable),contactsTableElement.innerHTML=buildContactsTableElement(contactsTable),showMain("main-contacts-table")}function clearContactFormEntries(contactsTable){let headers=contactsTable.headers;for(let j=0;j<headers.length;j++)document.getElementById("contact-"+headers[j]).value="";document.getElementById("contacts-row-index").value=-1,contactsEditFormMessage.innerHTML=""}function sortContactsByField(clickedHeaderElement){let field=clickedHeaderElement.innerHTML;confirm("Sort by "+clickedHeaderElement.innerHTML+"?")&&(destructiveSort(contactsTable.data,field,sortAscending),contactsTableElement.innerHTML=buildContactsTableElement(contactsTable),sortAscending*=-1)}function loadContactsTable(){if(confirm("This will overwrite current table")){let fileContents="",inputTypeIsFile=document.createElement("input");inputTypeIsFile.type="file",inputTypeIsFile.accept=".json",inputTypeIsFile.addEventListener("change",(function(){let inputFile=inputTypeIsFile.files[0],fileReader=new FileReader;fileReader.onload=function(fileLoadedEvent){fileContents=fileLoadedEvent.target.result,".json"===inputFile.name.slice(-5)&&(baseFilename=inputFile.name.slice(0,-5)),contactsTable=JSON.parse(fileContents),clearContactFormEntries(contactsTable),contactsTableElement.innerHTML=buildContactsTableElement(contactsTable)},fileReader.readAsText(inputFile,"UTF-8")})),inputTypeIsFile.click()}}function savecontactsTableElement(contactsTable){let str=JSON.stringify(contactsTable);baseFilename=contactsTable.name+getTodaysDate(),saveStringToTextFile(str,baseFilename,".json")}initializeContactsApp();</script>
    <script>function initializeCalendarApp(){document.getElementById("calendar-table-name").innerHTML=calendarDatabase.name}function processOpenCalendar(){let date=document.getElementById("calendar-date").value;console.log(date),""!==date&&(void 0===calendarDatabase.dates[date]&&(calendarDatabase.dates[date]={},calendarDatabase.dates[date].data=[]),document.getElementById("calendar-table-name").innerHTML="<span onclick='processCalendarHome();'>"+date+" &#128197;</span>",calendarTable.innerHTML=buildCalendarTableElement(date),showMain("main-calendar-table"),console.log(calendarDatabase))}function processCalendarHome(){showMain("main-calendar-start")}function processCalendarCSVClick(){let headers=calendarDatabase.headers,date=document.getElementById("calendar-date").value,data=calendarDatabase.dates[date].data,tempTable={};tempTable.headers=headers,tempTable.data=data,tempTable.name="Calendar",processCSVClick(tempTable)}function buildCalendarTableElement(date){sortCalendarByStartTime(date);let dataEntriesArrayForGivenDay=calendarDatabase.dates[date].data,tableElement="",numberOfColumns=calendarDatabase.headers.length,numberOfRows=dataEntriesArrayForGivenDay.length;tableElement+="<table>",tableElement+="<thead><tr>";for(let j=0;j<numberOfColumns;j++)tableElement+="<th onclick='//sortCalendarByField(this);'>"+calendarDatabase.headers[j]+"</th>";tableElement+="</tr></thead>",tableElement+="<tbody>";for(let i=0;i<numberOfRows;i++){tableElement+="<tr id='calendar-table-row-"+i.toString()+"' onclick=\"selectCalendarEditForm("+i.toString()+')">';for(let j=0;j<numberOfColumns;j++){let fieldName=calendarDatabase.headers[j];tableElement+="<td>"+dataEntriesArrayForGivenDay[i][fieldName]+"</td>"}tableElement+="</tr>"}return tableElement+="</tbody>",tableElement}function newCalendarEntry(table){calendarEditFormMessage.innerHTML=document.getElementById("calendar-date").value+": New Entry",calendarEditForm.innerHTML=buildCalendarEditForm(-1),showMain("main-calendar-form")}function selectCalendarEditForm(clickedRowIndex){calendarEditFormMessage.innerHTML=document.getElementById("calendar-date").value+": Entry "+clickedRowIndex.toString(),calendarEditForm.innerHTML=buildCalendarEditForm(clickedRowIndex),showMain("main-calendar-form")}function buildCalendarEditForm(index){let date=document.getElementById("calendar-date").value,thisEntry=calendarDatabase.dates[date].data[index],editForm="";editForm+="<form>",editForm="<input type='hidden' id='calendar-row-index' value='"+index.toString()+"'>";let numberOfColumns=calendarDatabase.headers.length,headers=calendarDatabase.headers,row=thisEntry,inputTypes=calendarDatabase.inputTypes;for(let j=0;j<numberOfColumns;j++){let extraString="";"number"===inputTypes[headers[j]]?extraString=" step='any' ":"tel"===inputTypes[headers[j]]&&(extraString=" placeholder='304-424-1000' pattern='[0-9]{3}-[0-9]{3}-[0-9]{4}' "),editForm+=-1===index?"<div><label for='"+headers[j]+"'>"+headers[j]+"</label></div><div><input type='"+inputTypes[headers[j]]+"' id='"+headers[j]+"' "+extraString+"></div>":"<div><label for='"+headers[j]+"'>"+headers[j]+"</label></div><div><input type='"+inputTypes[headers[j]]+"' id='"+headers[j]+"' value='"+row[headers[j]].replaceAll('"',"&quot;").replaceAll("'","&apos;")+"'"+extraString+"></div>"}return editForm+="</form>",editForm}function saveCalendarEntry(){let index=parseInt(document.getElementById("calendar-row-index").value),date=document.getElementById("calendar-date").value,headers=calendarDatabase.headers,row={};for(let j=0;j<headers.length;j++)row[headers[j]]=document.getElementById(headers[j]).value;index>=0?calendarDatabase.dates[date].data[index]=row:calendarDatabase.dates[date].data.push(row),clearCalendarFormEntries(),calendarTable.innerHTML=buildCalendarTableElement(date),showMain("main-calendar-table")}function purgeCalendar(){console.log(calendarDatabase.dates);let dates=calendarDatabase.dates;for(let date in dates)console.log(date),console.log(dates[date].data),console.log(dates[date].data.length),0===dates[date].data.length&&(t,delete dates[date]);console.log(calendarDatabase.dates)}function deleteCalendarEntry(){let index=parseInt(document.getElementById("calendar-row-index").value),date=document.getElementById("calendar-date").value;index>=0&&confirm("Delete this entry?")&&calendarDatabase.dates[date].data.splice(index,1),clearCalendarFormEntries(),calendarTable.innerHTML=buildCalendarTableElement(date),showMain("main-calendar-table")}function cancelCalendarEntry(){let date=document.getElementById("calendar-date").value;clearCalendarFormEntries(),calendarTable.innerHTML=buildCalendarTableElement(date),showMain("main-calendar-table")}function clearCalendarFormEntries(){let headers=calendarDatabase.headers;for(let j=0;j<headers.length;j++)document.getElementById(headers[j]).value="";document.getElementById("calendar-row-index").value=-1,calendarEditFormMessage.innerHTML=""}function sortCalendarByStartTime(date){let field=calendarDatabase.headers[0];destructiveSort(calendarDatabase.dates[date].data,field)}function sortCalendarByField(clickedHeaderElement){let date=document.getElementById("calendar-date").value,field=clickedHeaderElement.innerHTML;calendarDatabase.dates[date].data.length>1&&confirm("Sort by "+clickedHeaderElement.innerHTML+"?")&&(destructiveSort(calendarDatabase.dates[date].data,field,sortAscending),calendarTable.innerHTML=buildCalendarTableElement(date),sortAscending*=-1)}function loadCalendarDatabase(){if(confirm("This will overwrite current table")){let fileContents="",inputTypeIsFile=document.createElement("input");inputTypeIsFile.type="file",inputTypeIsFile.accept=".json",inputTypeIsFile.addEventListener("change",(function(){let inputFile=inputTypeIsFile.files[0],fileReader=new FileReader;fileReader.onload=function(fileLoadedEvent){fileContents=fileLoadedEvent.target.result,calendarDatabase=JSON.parse(fileContents)},fileReader.readAsText(inputFile,"UTF-8")})),inputTypeIsFile.click()}}function saveCalendarDatabase(calendarDatabase){let str=JSON.stringify(calendarDatabase),baseFilename=calendarDatabase.name+getTodaysDate();saveStringToTextFile(str,baseFilename,".json")}</script>
    <script>function initializeCalculatorApp(){calculatorInput.addEventListener("keypress",(function(event){"Enter"===event.key&&document.getElementById("equals-button").click()}))}function buildCalcString(clickedElement){"CLR"===clickedElement.innerHTML?(calculatorInput.value="",calcString="",calculatorInput.value=calcString,expressionSpan.innerHTML=""):"←"===clickedElement.innerHTML?(calcString=calculatorInput.value,calcString=calcString.slice(0,-1),calculatorInput.value=calcString):"="===clickedElement.innerHTML?evaluateExpression(calculatorInput.value):(calcString=calculatorInput.value,charToAdd=clickedElement.innerHTML,"x"===charToAdd&&(charToAdd="*"),calcString+=charToAdd,calculatorInput.value=calcString)}function getAnOperator(str){let operators=["/","*","-","+"];"-"===(str=str.trim())[0]&&(str=str.slice(1));for(let i=0;i<operators.length;i++)if(str.includes(operators[i]))return operators[i];return-1}function justOneOperator(str){let operators=["/","*","-","+"],operatorCount=0;"-"===(str=str.trim())[0]&&(str=str.slice(1));for(let i=0;i<operators.length;i++)operatorCount+=str.split(operators[i]).length-1;return 1!=operatorCount&&console.log("incorrect operator count",operatorCount),1===operatorCount}function tokenEmpty(str,operator){for(token of("-"===(str=str.trim())[0]&&(str=str.slice(1)),tokens=str.split(operator),tokens))token=token.trim();return 2!=tokens.length?(console.log("incorrect number of tokens"),!0):""===tokens[0]?(console.log("first token empty"),!0):""===tokens[1]&&(console.log("second token empty"),!0)}function evaluateExpression(str){console.log("expression to evaluate",str),expressionSpan.innerHTML="evaluating: "+str;let result="can't evaluate";if(justOneOperator(str)){let operator=getAnOperator(str);if(!1===tokenEmpty(str,operator)){let tokens=getTokens(str,operator);console.log("operator",operator,"tokens",tokens),result=proceedWithEvaluation(tokens,operator).toString()}}console.log(result),"NaN"===Number(result).toString()?calculatorInput.style.backgroundColor="orange":(console.log(convertEStringToDecimalString(result)),calculatorInput.value=convertEStringToDecimalString(result),calcString=result,calculatorInput.style.backgroundColor="field")}function getTokens(str,operator){let token0Prefix="";"-"===(str=str.trim())[0]&&(str=str.slice(1),token0Prefix="-");let tokens=str.split(operator);for(let token of tokens)token.trim();return tokens[0]=token0Prefix+tokens[0],tokens}function proceedWithEvaluation(tokens,operator){return"+"===operator?Number(tokens[0])+Number(tokens[1]):"-"===operator?Number(tokens[0])-Number(tokens[1]):"/"===operator?Number(tokens[0])/Number(tokens[1]):"*"===operator?Number(tokens[0])*Number(tokens[1]):NaN}function convertEStringToDecimalString(str){let result=str.toString();if(result.includes("e+")){let power=result.split("e+")[1],number=result.split("e+")[0];number.includes(".")||(number+=".");let numberLeft=number.split(".")[0],numberRight=number.split(".")[1],addToRightNumberLength=parseInt(power)-numberRight.length,addZeros="";for(let i=0;i<addToRightNumberLength;i++)addZeros+="0";numberRight+=addZeros,result=numberLeft+numberRight}else if(result.includes("e-")){let power=result.split("e-")[1],number=result.split("e-")[0];number.includes(".")||(number+=".");let numberLeft=number.split(".")[0],numberRight=number.split(".")[1],addToLeftNumberLength=parseInt(power)-numberLeft.length,addZeros="";for(let i=0;i<addToLeftNumberLength;i++)addZeros+="0";result="0."+addZeros+numberLeft+numberRight}return console.log("input string was",str),console.log("output string is",result),console.log("Number(result)",Number(result)),result}</script>
    <script>
        showMain('main-startup');
        window.onbeforeunload = askConfirm;
    </script>
</body>

</html>
