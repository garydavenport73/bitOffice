<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><style>html{box-sizing:border-box;font-size:16px}*,*:before,*:after{box-sizing:inherit}body,h1,h2,h3,h4,h5,h6,p,ol,ul{margin:0;padding:0;font-weight:400}ol,ul{list-style:none}img{max-width:100%;height:auto}html{background-color:#f0f8ff}h1:not(#document-result h1){color:#e6e6fa;background-color:#0000cd;font-family:Arial,Helvetica,sans-serif;font-size:32px;font-weight:700;padding:2px}#top-nav{color:#fff;background-color:#0000cd;padding-bottom:2px}#top-nav button{font-size:1.4rem;padding:5px;margin:1px;min-height:25px;background-color:#e0e0e0;border:#e0e0e0;border-radius:5px}h2:not(#document-result h2){margin:16px;font-weight:700;text-align:center;padding:2px;border-radius:5px;font-family:Arial,Helvetica,sans-serif;border:1px solid grey}#main-planner h2{color:#000;background-color:orange}#main-notes h2{background-color:orange;color:#000}#main-write h2{background-color:#5f9ea0}#main-tables h2{background-color:#228b22;color:#faebd7}#main-write h2{background-color:#5f9ea0;color:#faebd7}#main-calculator h2{background-color:dimgrey;color:snow}#document-result h1,#document-result h2,#document-result h3,#document-result h4{background-color:unset;color:unset}#document-result *{background-color:unset;width:unset;text-align:unset;border-radius:unset;margin-left:unset;margin-right:unset;width:unset;padding-bottom:unset;align-items:unset;border-radius:unset;margin:unset;padding:unset}#document-parent{margin:0;padding:0;width:100%;background-color:#fafad2}#document-result{overflow-wrap:break-word;min-height:100px;width:auto;background-color:#fafad2;white-space:pre-wrap}main{background-color:#e0e0e0}body{width:320px;background-color:#87cefa;background-color:#e0e0e0;margin:auto;padding:5px;box-sizing:border-box}h1:not(#document-result h1),h2:not(#document-result h2),h3:not(#document-result h3),nav{display:flex;flex-direction:row;justify-content:center}#edit-bar,#document-settings{display:flex;justify-content:left;flex-wrap:wrap;background-color:#5f9ea0;border:1px solid #000;margin:0;padding:0}#edit-bar button,#document-settings button{border-radius:5px;background-color:#e0e0e0;border:1px solid grey;padding:1px 4px;margin:0}#text-editor{width:100%;max-width:100%;overflow-wrap:break-word;min-height:100px;margin-top:0;margin-bottom:0}footer{position:fixed;bottom:0;left:50%;transform:translate(-50%,0%)}button{padding:5px}#main-planner,#main-notes,#main-write,#main-tables,#main-calculator{display:flex;flex-direction:column}#planner-ribbon>button{font-size:18px}main{min-height:320px}#planner-contacts-form *,#planner-calendar-form *{width:100%;display:auto;box-sizing:border-box}#planner-planner-help ul li,#tables-help ul li{list-style-position:inside;list-style-type:disc;margin:0 15px}#planner-planner-help ol li,#tables-help ol li{list-style-position:inside;list-style-type:decimal;margin:0 15px}#planner-planner-help p,#tables-help p{margin:15px}#planner-help,#tables-help pre{font-size:12px}#Description{height:100px}.table-container table,.table-container table td,.table-container table th{border:1px solid #000;border-collapse:collapse}.table-container pre{white-space:pre-wrap;font-size:12px;word-break:break-all}.table-container table{box-sizing:border-box;margin:auto;width:100%}#contacts-table th,#contacts-table td,#calendar-table th,#calendar-table td{display:none}#calendar-table th:nth-of-type(1),#calendar-table th:nth-of-type(2),#calendar-table th:nth-of-type(3),#calendar-table td:nth-of-type(1),#calendar-table td:nth-of-type(2),#calendar-table td:nth-of-type(3){display:table-cell}#contacts-table td:nth-of-type(1),#contacts-table th:nth-of-type(1),#contacts-table th:nth-of-type(4),#contacts-table td:nth-of-type(4){display:table-cell}#contacts-table th:nth-of-type(3),#contacts-table td:nth-of-type(3){display:table-cell}#calendar-container{margin:10px;display:flex;flex-direction:column;align-items:center}#special-calendar{background-color:snow;font-family:Arial,Verdana,Helvetica,Tahoma,sans-serif;font-size:16px;padding:0;margin:0;background-color:#fff}#special-calendar table td{height:32px;text-align:center;width:32px}#special-calendar{border:1px solid grey;width:240px}#month-chooser{background-color:#f5f5f5;min-height:30px;border-radius:5px;width:240px;text-align:center;font-family:Arial,Helvetica,sans-serif;font-size:16px}#calendar-date{display:none}main h3{background-color:#e0e0e0}.nested-menu:hover{color:snow;background-color:grey}#tables-table th:hover:not(:first-of-type),#tables-table td:first-of-type:hover{background-color:#fff}#add-row:hover,#add-column:hover{background-color:#fff}#add-column{min-width:1rem}.table-container{display:block;overflow-x:auto;margin-left:auto;margin-right:auto;width:100%;text-align:center}#tables-table input{width:100%;border:none}#tables-table input:hover{background-color:lightgrey}#tables-table td{padding:0}#tables-table th:not(:last-of-type){min-width:3rem}#tables-table th:first-of-type{min-width:1rem}#tables-table{border:none}#tables-table th{border:none}.tables-table-row-number{border:none!important}#tables-table{background-color:lightgrey}#tables-table-table{}#tables-tables-header-form>div,#tables-tables-row-form>div{display:flex;flex-direction:column;text-align:center;width:50%;margin:auto}#tables-tables-header-form *,#tables-tables-row-form *{text-align:center}#tables-tables-header-form>div>div,#tables-tables-row-form>div>div{margin:5px 0}#tables-tables-header-form>div>div>*,#tables-tables-row-form>div>div>*{width:100%}#calculator-table{width:100%;min-width:0%}#calculator-table td button{font-size:2rem;width:100%;height:4rem}.special-calculator-button{background-color:#fc3;border:1px solid grey}#last-calculator-expression{overflow-wrap:anywhere;min-height:18px;color:grey}#calculator-input{width:100%;height:40px;font-size:1.4rem;text-align:right}#calc-clr button{width:50%;font-size:1.4rem;padding:5px}main nav button{background-color:#e0e0e0;border:1px solid grey;border-radius:3px}#startup-load-button,#startup-save-button{font-size:1.4rem}#planner-load,#planner-save{margin:40px}#planner-contacts-table,#planner-calendar-start{margin-top:1rem}#planner-contacts-table nav,#planner-calendar-start nav{min-height:36px}#new-contacts-button{font-size:1.4rem;padding:4px 10px}#contacts-table{margin-top:10px}</style><link id="favicon-link" rel="icon" type="image/x-icon" href="">
<title>bitOffice</title>
</head>

<body>
    <h1 onclick="alert(license);">bitOffice</h1>
    <nav id="top-nav">
        <button onclick="showMain('main-planner');">&#9742;&#128197;</button>
        <button onclick="showMain('main-notes');">&#128196;</button>
        <button onclick="showMain('main-write');">&#128221;</button>
        <button onclick="showMain('main-tables');">&#9638;</button>
        <button onclick="showMain('main-calculator');">&#128290;</button>
        <!-- <button onclick="saveSelf()">&darr;</button> -->
    </nav><main id="main-tables">
    <h2>Tables</h2>
    <nav>
        <button onclick="tablesNewTable();">New</button>
        <button onclick="tablesLoad();">Load</button>
        <button onclick="tablesSave();">Save</button>
        <button onclick="tablesCopyCSVToClipboard()">Copy</button>
        <button onclick="showTablesDiv('tables-help');">?</button>
    </nav>
    <div class="tables-div" id="tables-tables-table">

        <div class="table-container">
            <table id="tables-table">
            </table>
        </div>
    </div>
    <div class="tables-div" id="tables-tables-header-form">
        <!-- <h2>Tables</h2> -->
        <div>
            <h3>Column: <span id="tables-current-header">header name here</span></h3>

            <div class="surround-box">
                <button onclick="updateHeaderName();">Change name to:</button>
                <input id="tables-new-header-name" type="text" placeholder="name">
            </div>
            <div class="surround-box">
                <button onclick="deleteColumn();">Delete Column</button>
                <button onclick="copyColumn()">Copy Column</button>
            </div>
            <div class="surround-box">
                <button onclick="moveColumn()">Move To Column</button><select id="move-column"></select>
            </div>
            <div>
                <button onclick="calculateTotal()">Add Total</button>
                <button onclick="calculateAverage()">Compute Average</button>
            </div>
            <div>
                <button onclick="tablesSort(1)">Sort Ascending &uarr;</button>
                <button onclick="tablesSort(-1)">Sort Descending &darr;</button>
            </div>
            <div>
                <button onclick="tablesCancel()">Cancel</button>
            </div>
        </div>
    </div>
    <div class="tables-div" id="tables-tables-row-form">
        <!-- <h2>Tables</h2> -->
        <div>
            <h3>Row: <span id="tables-current-row">row number here</span></h3>
            <div>
                <button onclick="deleteRow()">Delete Row</button>
                <button onclick="copyRow()">Copy Row</button>
            </div>
            <div>
                <button onclick="moveRow()">Move To Row</button>
                <select id="move-row"></select>
            </div>
            <div>
                <button onclick="tablesCancel()">Cancel</button>
            </div>
        </div>
    </div>
    <div class="tables-div" id="tables-help">
        <p>
        <h3>Tables-Help</h3>
        </p>
        <p>
        <nav><button onclick="showTablesDiv('tables-tables-table');">Back To Table</button></nav>
        </p>
        <p>FORMATTING RULES:</p>
        <p>When Saving:
        <ol>
            <li>All cells are quoted text.
            </li>
            <li>Interior double quotes in cells are converted like this: "-&gt;""</li>
        </ol>
        </p>
        <p>If loading CSV from other apps:
        <ol>
            <li>Cells should all be text type.</li>
            <li>Quote all text strings when saving is best practice.</li>
            <li>There should be no spaces or tabs between the comma delimiter.</li>
            <li>Interior double quotation marks (i.e. ") in a cell should be stored as ""</li>
        </ol>
        </p>
        <p>
            For example, these 2 cell contents:
        <pre>  She said "Yeah, Yeah, Yeah",Hi</pre>
        </p>
        <p>
            Would be stored as
        <pre>  "She said ""Yeah, Yeah, Yeah""","Hi"</pre>
        </p>
        <hr>
        <p>
            <i>Notes on CSV:</i>
        </p>
        <p>
            There is no universal standard among programs, but this program uses the following standards
            adapted from <a href="https://en.wikipedia.org/wiki/Comma-separated_values#Standardization" target="_blank">RFC 4180 and MIME standards</a>.:
        <ul>
            <li>Each record should contain the same number of comma-separated fields.</li>
            <li>Any field may be quoted (with double quotes).</li>
            <li>If double-quotes are used to enclose fields, then a double-quote in a field must be represented by two double-quote characters. (internal " is escaped with "")</li>
            <li>Some type of carriage return/line feed must be used- this program uses the "\n" convention, not "\r\n".</li>
        </ul>
        </p>
    </div>
</main><footer onclick="alert(license);">bitOffice &copy; 2022</footer><script>let license='MIT License\n\nCopyright (c) 2022 Gary Davenport\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.'function _replaceReallCommmasInCSV(c,d){let a="",b=-1;for(let f=0;f<c.length;f++){let e=c.charAt(f);e==='"'?(b=b*-1,a+=e):e===","?b===-1?a+=d:a+=e:a+=e}return a}function _replaceRealNewlinesInCSV(c,d){let a="",b=-1;for(let f=0;f<c.length;f++){let e=c.charAt(f);e==='"'?(b=b*-1,a+=e):e==="\n"?b===-1?a+=d:a+=e:a+=e}return a}function _replaceRealCommasAndRealNewlinesInCSV(c,d,e){let a="",b=-1;for(let g=0;g<c.length;g++){let f=c.charAt(g);f==='"'?(b=b*-1,a+=f):f===","?b===-1?a+=d:a+=f:f==="\n"?b===-1?a+=e:a+=f:a+=f}return a}function tokenMaker(c){let a="",b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(let d=0;d<c;d++)a+=b[Math.floor(Math.random()*b.length)];return a}function escapeRegExp(a){return a.replace(/[.*+?^${}()|[\]\\]/g,'\\$&')}function myReplaceAll(a,b,c){return a.replace(new RegExp(escapeRegExp(b),'g'),()=>c)}function getTokenNotInString(b,c=16){let a=tokenMaker(16);while(b.indexOf(a)!==-1)a=tokenMaker(16);return a}function csvToArrays(a){a=a.trim();let b=getTokenNotInString(a);a=a.split("\r").join(b),a=a.split(b+"\n").join("\n");let c=[];a=a.trim();let d=getTokenNotInString(a);a=_replaceReallCommmasInCSV(a,d);let e=getTokenNotInString(a);a=_replaceRealNewlinesInCSV(a,e);let f=a.split(e);for(let b=0;b<f.length;b++){let a=f[b].split(d);for(let b=0;b<a.length;b++)a[b][a[b].length-1]==='"'&&(a[b]=a[b].slice(0,a[b].length-1)),a[b][0]==='"'&&(a[b]=a[b].slice(1,a[b].length)),a[b]=a[b].split('""').join('"');c.push(a)}return c}function arraysToCSV(b,c="\n"){let a="";for(let d=0;d<b.length;d++){for(let c=0;c<b[d].length;c++)a+='"',a+=b[d][c].split('"').join('""'),a+='",';a=a.slice(0,-1)+c}return a=a.slice(0,-c.length),a}function arraysToJSON(b,d=!0){let a=[],e=[],c={};if(d===!0)for(let d=0;d<b[0].length;d++){let c=b[0][d],e=0;while(a.includes(c))console.log("WARNING - Duplicate header found: "+c),e+=1,c=c+e.toString(),console.log("Attempting rename to: "+c);a.push(c)}else for(let c=0;c<b[0].length;c++)a.push("header"+c.toString());d===!0?startRow=1:startRow=0;for(let c=startRow;c<b.length;c++){let d={};for(let e=0;e<a.length;e++)d[a[e]]=b[c][e];e.push(d)}return c.headers=a,c.data=e,c}function JSONToArrays(d,e=!0){let a=d.headers,b=d.data,c=[];if(e===!0){let b=[];for(let c=0;c<a.length;c++)b.push(a[c].toString());c.push(b)}for(i=0;i<b.length;i++){let d=[];for(let c=0;c<a.length;c++)b[i][a[c]]===void 0?d.push(""):d.push(b[i][a[c]].toString());c.push(d)}return c}function unorderedJSONToArrays(c,d=!0){let a={};a.data=c;let b=[];for(rowObject of c)for(const a in rowObject)b.includes(a)||b.push(a.toString());return a.headers=b,JSONToArrays(a,d)}function csvToJSON(b,c=!0){let a=csvToArrays(b);console.log(a);let d=arraysToJSON(a,c);return d}function JSONToCSV(a,b=!0,c="\n"){let d=JSONToArrays(a,b),e=arraysToCSV(d,c);return e}function unorderedJSONToCSV(a,b=!0){let c=unorderedJSONToArrays(a,b),d=arraysToCSV(c);return d}function saveStringToTextFile(b,h="myfile",c=".txt",d="text/plain"){let e=h+c,f=new Blob([b],{type:d}),g=window.URL.createObjectURL(f),a=document.createElement("a");a.style.display="none",a.download=e,a.href=g,document.body.appendChild(a),a.click(),a.parentElement.removeChild(a)}function copyAndSaveString(a,b="myfile",c=".txt",d="text/plain"){copyToClipBoard(a,!1),confirm("Copied to clipboard, save to file also?")&&saveStringToTextFile(a,b,c,d)}function saveWebsiteAsTextFile(b){let a=new XMLHttpRequest;a.timeout=2e3,a.ontimeout=function(a){alert("The request timed out.")},a.open('GET',b,!0),a.onreadystatechange=function(){a.readyState==4&&a.status==200&&(alert(a.responseText),console.log(a.responseText))},a.send()}function saveSelf(){let a=document.getElementsByTagName("title")[0].innerText;confirm("Duplicate and download "+a+" ?")&&saveStringToTextFile(selfString,a+"Clone",".html")}function getTodaysDate(){let a=new Date,b=("0"+a.getDate()).slice(-2),c=("0"+(a.getMonth()+1)).slice(-2),d=a.getFullYear()+"-"+c+"-"+b;return d}function getFirstDayOfThisMonthDate(){let a=new Date,b="01",c=("0"+(a.getMonth()+1)).slice(-2);return a.getFullYear()+"-"+c+"-"+b}function getLastDayOfThisMonthDate(){let b=new Date,a=daysInThisMonth().toString();a="0"+a,a=a.slice(-2);let c=("0"+(b.getMonth()+1)).slice(-2);return b.getFullYear()+"-"+c+"-"+a}function daysInSomeMonth(a,b){return new Date(b,a+1,0).getDate()}function daysInThisMonth(){return thisDate=new Date,thisMonth=thisDate.getMonth(),thisYear=thisDate.getYear(),daysInSomeMonth(thisMonth,thisYear)}function getDayOfWeek(a){let b=new Date(a+"T00:00");return b.getDay()}function serializeElementToPage(d,e=""){let f="<!DOCTYPE html><html lang='en'><head><meta charset='UTF-8'><meta http-equiv='X-UA-Compatible' content='IE=edge'><meta name='viewport' content='width=device-width, initial-scale=1.0'><title></title><style>",a=document.getElementsByTagName('style'),b="";for(let c=0;c<a.length;c++)b=a[c].innerHTML;let g="</style></head><body>",h="</body></html>",i=new XMLSerializer,j=document.getElementById(d),k=i.serializeToString(j),c=f+b+e+g+k+h;return console.log(c),c}function simulateUndo(){document.execCommand('undo',!1,null)}function simulateRedo(){document.execCommand('redo',!1,null)}function askConfirm(){return"Did you remember to save your data?"}function showMain(a){let b=document.getElementsByTagName('main');for(let a of b)a.style.display="none";document.getElementById(a).style.display="flex"}function copyToClipBoard(b,c=!0){let a=document.createElement('textarea');return a.value=b,a.setAttribute('readonly',''),a.style={position:'absolute',left:'-9999px'},document.body.appendChild(a),a.select(),document.execCommand('copy'),document.body.removeChild(a),c&&alert('Copied to Clipboard.'),b}function fillInEmptyPropertyValues(c){let a=c.data,b=c.headers;for(let c=0;c<a.length;c++)for(let d=0;d<b.length;d++)a[c][b[d]]===void 0&&(a[c][b[d]]="")}function makeCSV(a,b=!0){return JSONToCSV(a,b,"\n")}function tokenMaker(c){let a="",b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",d=0;for(let d=0;d<c;d++)a+=b[Math.floor(Math.random()*b.length)];return console.log(a),a}function processCSVClick(b){let a="";a=makeCSV(b,!0),copyToClipBoard(a),confirm("Table copied to CSV.\n\nSave to file also?")&&copyAndSaveString(a,b.name+getTodaysDate(),".csv")}function destructiveSort(c,a,b=1){b!=-1&&(b=1),c.sort((c,d)=>c[a]<d[a]?-1*b:c[a]>d[a]?1*b:0)}function destructiveDoubleSortAscending(c,a,b){c.sort((c,d)=>c[a]>d[a]?1:c[a]<d[a]?-1:c[b]>d[b]?1:c[b]<d[b]?-1:0)}function makeFavicon(d,e,f){let a=document.createElement('canvas');a.width=16,a.height=16;let c=a.getContext('2d');c.fillStyle=f,c.fillRect(0,0,16,16);let b=a.getContext("2d");b.fillStyle=e,b.font="bold 12px Arial",b.fillText(d,4,12);let g=document.getElementById("favicon-link");g.href=a.toDataURL("image/x-icon")}let tableElement=document.getElementById('tables-table'),tablesTable={name:"Table",headers:["Column 1","Column 2","Column 3"],data:[{"Column 1":"","Column 2":"","Column 3":""},{"Column 1":"","Column 2":"","Column 3":""},{"Column 1":"","Column 2":"","Column 3":""}]},initialTablesTable=JSON.stringify(tablesTable);initializeTablesApp();function showTablesDiv(a){updateDataFromCurrentInputs(tablesTable);let b=document.getElementsByClassName('tables-div');for(let a of b)a.style.display="none";document.getElementById(a).style.display="unset"}function initializeTablesApp(){makeTable(JSON.parse(initialTablesTable)),updateDataFromCurrentInputs(tablesTable),showTablesDiv('tables-tables-table')}function backupTablesTable(){return updateDataFromCurrentInputs(tablesTable),JSON.parse(JSON.stringify(currentTablesTable))}function processColumnClick(a){updateDataFromCurrentInputs(tablesTable),populateMoveColumnSelect(tablesTable),document.getElementById("tables-current-header").innerHTML=a,document.getElementById("tables-new-header-name").value=a,showTablesDiv("tables-tables-header-form")}function processRowClick(a){updateDataFromCurrentInputs(tablesTable),populateMoveRowSelect(tablesTable),document.getElementById("tables-current-row").innerHTML=a.toString(),showTablesDiv("tables-tables-row-form")}function makeTable(d){let a="";a="";let b=d.headers;a+="<thead><tr><th></th>";for(let c=0;c<b.length;c++)a+="<th id='"+b[c]+"' onclick=\"processColumnClick('"+b[c]+"');\">"+b[c].replace(/</g,"&lt;").replace(/>/g,"&gt;"),+"</th>";a+="<th id='add-column' onclick='addColumn(tablesTable)'>+</th>",a+="</tr></thead>";let f=a;a="<tbody>";let c=d.data;console.log("bodyData"),console.log(c);let g=c.length;for(let d=0;d<g;d++){a+="<tr><td class='tables-table-row-number' onclick='processRowClick("+d.toString()+")'>"+d.toString()+"</td>";let e=b.length;console.log(e);for(let f=0;f<e;f++)c[d][b[f]]===void 0&&(c[d][b[f]]="input read error"),a+="<td><input type='text' id='cell-"+d.toString()+"-"+f.toString()+"' value='"+c[d][b[f]].toString()+"'></td>";a+="</tr>"}a+="</tbody>";let h=a;a="<tfoot><tr><th id='add-row' onclick='addRow(tablesTable)'>+</th>";for(let c=0;c<b.length;c++)a+="<th id='footer-"+(c+1).toString()+"' onclick=\"processColumnClick('"+b[c]+"');\"></th>";a+="</tr></tfoot>";let i=a,e=f+h+i;return populateMoveColumnSelect(d),populateMoveRowSelect(d),tableElement.innerHTML=e,e}function populateMoveColumnSelect(b){let a=document.getElementById('move-column');a.options.length=0;let c=b.headers;for(th of c){let b=document.createElement('option');b.value=th,b.text=th,a.add(b)}}function populateMoveRowSelect(b){let a=document.getElementById('move-row');a.options.length=0;for(let c=0;c<b.data.length;c++){let d=document.createElement('option');d.value=c.toString(),d.text=c.toString(),a.add(d)}}function updateDataFromCurrentInputs(a){let b=a.headers;console.log("headers"),console.log(b);for(let c=0;c<a.data.length;c++)for(let d=0;d<a.headers.length;d++){let e="cell-"+c.toString()+"-"+d.toString(),f=document.getElementById(e);a.data[c][b[d]]=f.value}}function updateHeaderName(){let b=document.getElementById("tables-current-header").innerHTML,a=document.getElementById('tables-new-header-name').value;if(b===a){makeTable(tablesTable);return}if(a==="")if(a=prompt("There is no name listed, please enter the new name"),a===null)return;tablesTable=_changeHeaderAndDataPropertyName(tablesTable,a,b),makeTable(tablesTable),showTablesDiv('tables-tables-table')}function tablesSort(a){let b=document.getElementById("tables-current-header").innerHTML;sortTablesByField(b,a)}function sortTablesByField(a,b=1){confirm("Sort by "+a+"?\n\nThis is destructive and irreversible.")&&(destructiveSort(tablesTable.data,a,b),makeTable(tablesTable),showTablesDiv('tables-tables-table'))}function _changeHeaderAndDataPropertyName(a,b,d){let c=a.data;b=getBestName(a,b);let e=a.headers.indexOf(d);a.headers[e]=b;for(let a=0;a<c.length;a++)c[a][b]=c[a][d],delete c[a][d];return a}function deleteColumn(){let a=document.getElementById("tables-current-header").innerHTML;if(confirm("Are you sure? \n\nDelete Column: "+a+"?")){let b=tablesTable.headers.indexOf(a);tablesTable.headers.splice(b,1);for(let b=0;b<tablesTable.data.length;b++)delete tablesTable.data[b][a];makeTable(tablesTable),showTablesDiv('tables-tables-table')}}function addColumn(a){updateDataFromCurrentInputs(a);let b=1,c="new"+b.toString();while(a.headers.includes(c))console.log("column name already in use"),b+=1,c="new"+b.toString();a.headers.push(c),fillInEmptyPropertyValues(a),makeTable(a)}function moveColumn(){let a=document.getElementById("tables-current-header").innerHTML,b=document.getElementById("move-column").value;if(a===b){console.log("destination is same as source");return}let c=tablesTable.headers.indexOf(a),d=tablesTable.headers.indexOf(b),e=tablesTable.headers.splice(c,1)[0];tablesTable.headers.splice(d,0,e),makeTable(tablesTable),showTablesDiv('tables-tables-table')}function getBestName(d,b){let e=d.headers,c=0,a=b;while(e.includes(a))console.log("column name already in use"),c+=1,a=b+"-"+c.toString();return a}function copyColumn(){let a=document.getElementById("tables-current-header").innerHTML,b=getBestName(tablesTable,a);tablesTable.headers.push(b);for(let c=0;c<tablesTable.data.length;c++)tablesTable.data[c][b]=tablesTable.data[c][a];makeTable(tablesTable),showTablesDiv('tables-tables-table')}function calculateTotal(){let b=document.getElementById("tables-current-header").innerHTML,a=0;for(let c of tablesTable.data)a=a+Number(c[b]);confirm("The total is: "+a.toString()+"\nCopy to clipboard?")&&copyToClipBoard(a.toString()),showTablesDiv('tables-tables-table')}function tablesCancel(){console.log("tablesCancel called"),makeTable(tablesTable),showTablesDiv('tables-tables-table')}function calculateAverage(){alert("calculate average called"),console.log("calcualtoe average called");let c=document.getElementById("tables-current-header").innerHTML,a=0;for(let b of tablesTable.data)a=a+Number(b[c]);let b=a/tablesTable.data.length;confirm("The average is: "+b.toString()+"\nCopy to clipboard?")&&copyToClipBoard(b.toString()),showTablesDiv('tables-tables-table')}function addRow(a){let c=a.headers;updateDataFromCurrentInputs(a);let d=a.headers.length,b={};for(let a=0;a<d;a++)b[c[a]]="";a.data.push(b),makeTable(a)}function deleteRow(){let a=parseInt(document.getElementById("tables-current-row").innerHTML),b=tablesTable.data;b.splice(a,1),makeTable(tablesTable),showTablesDiv('tables-tables-table')}function copyRow(){console.log("copy row called");let b=parseInt(document.getElementById("tables-current-row").innerHTML),a=tablesTable.data;console.log(a);let c=JSON.parse(JSON.stringify(tablesTable.data[b]));a.push(c),makeTable(tablesTable),showTablesDiv('tables-tables-table')}function moveRow(){console.log("move row called");let b=parseInt(document.getElementById("tables-current-row").innerHTML),a=tablesTable.data,c=parseInt(document.getElementById("move-row").value),d=a.splice(b,1)[0];a.splice(c,0,d),makeTable(tablesTable),showTablesDiv('tables-tables-table')}function tablesNewTable(){confirm("Are you sure?  This will erase all current data.")&&initializeTablesApp()}function tablesLoad(){console.log("tablesLoad() called");let b="",a=document.createElement('input');a.type="file",a.accept=".csv",a.addEventListener("change",function(){let d=a.files[0],c=new FileReader;c.onload=function(a){b=a.target.result,confirm("Use the first line as the header row?")?tablesTable=csvToJSON(b,!0):tablesTable=csvToJSON(b,!0),makeTable(tablesTable)},c.readAsText(d,"UTF-8")}),a.click()}function tablesSave(){console.log("tablesSave() called"),updateDataFromCurrentInputs(tablesTable),confirm("Include header as first line in csv file?")?saveStringToTextFile(makeCSV(tablesTable,!0),"csvTable"+getTodaysDate(),".csv"):saveStringToTextFile(makeCSV(tablesTable,!1),"csvTable"+getTodaysDate(),".csv")}function tablesCopyCSVToClipboard(){updateDataFromCurrentInputs(tablesTable);let a="";return confirm("Include header as first line?")?a=copyToClipBoard(makeCSV(tablesTable,!0)):a=copyToClipBoard(makeCSV(tablesTable,!1)),a}let nestedMenues=document.getElementsByClassName("nested-menu");for(let a of nestedMenues)a.addEventListener("click",a=>{toggleNest(a.target)});function toggleNest(a){let b=a.parentElement.children;for(let c of b)c===a||(c.style.display==="none"?c.style.display="inherit":c.style.display="none")}function toggleAll(){for(let a of nestedMenues)toggleNest(a)}function openSelectedInitialNests(){for(let a of nestedMenues)a.classList.contains("initial-open")&&toggleNest(a)}toggleAll(),openSelectedInitialNests()</script><script>let selfString="";function createSelf(){let a=document.getElementsByTagName("html")[0].innerHTML;selfString+="<!DOCTYPE html><html lang='en'>"+a+"</html>"}window.onload=createSelf()makeFavicon("p", "white", "mediumblue");
window.onbeforeunload = askConfirm;
document.getElementById("top-nav").style.display="none";
showTablesDiv('tables-tables-table');//used for table
showMain('main-tables');
</script></body>
</html>