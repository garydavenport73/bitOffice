<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><style>html{box-sizing:border-box;font-size:16px}*,*:before,*:after{box-sizing:inherit}body,h1,h2,h3,h4,h5,h6,p,ol,ul{margin:0;padding:0;font-weight:400}ol,ul{list-style:none}img{max-width:100%;height:auto}html{background-color:#f0f8ff}h1:not(#document-result h1){color:#e6e6fa;background-color:#0000cd;font-family:Arial,Helvetica,sans-serif;font-size:32px;font-weight:700;padding:2px}#top-nav{color:#fff;background-color:#0000cd;padding-bottom:2px}#top-nav button{font-size:1.4rem;padding:5px;margin:1px;min-height:25px;background-color:#e0e0e0;border:#e0e0e0;border-radius:5px}h2:not(#document-result h2){margin:16px;font-weight:700;text-align:center;padding:2px;border-radius:5px;font-family:Arial,Helvetica,sans-serif;border:1px solid grey}#main-planner h2{color:#000;background-color:orange}#main-notes h2{background-color:orange;color:#000}#main-write h2{background-color:#5f9ea0}#main-tables h2{background-color:#228b22;color:#faebd7}#main-write h2{background-color:#5f9ea0;color:#faebd7}#main-calculator h2{background-color:dimgrey;color:snow}#document-result h1,#document-result h2,#document-result h3,#document-result h4{background-color:unset;color:unset}#document-result *{background-color:unset;width:unset;text-align:unset;border-radius:unset;margin-left:unset;margin-right:unset;width:unset;padding-bottom:unset;align-items:unset;border-radius:unset;margin:unset;padding:unset}#document-parent{margin:0;padding:0;width:100%;background-color:#fafad2}#document-result{overflow-wrap:break-word;min-height:100px;width:auto;background-color:#fafad2;white-space:pre-wrap}main{background-color:#e0e0e0}body{width:320px;background-color:#87cefa;background-color:#e0e0e0;margin:auto;padding:5px;box-sizing:border-box}h1:not(#document-result h1),h2:not(#document-result h2),h3:not(#document-result h3),nav{display:flex;flex-direction:row;justify-content:center}#edit-bar,#document-settings{display:flex;justify-content:left;flex-wrap:wrap;background-color:#5f9ea0;border:1px solid #000;margin:0;padding:0}#edit-bar button,#document-settings button{border-radius:5px;background-color:#e0e0e0;border:1px solid grey;padding:1px 4px;margin:0}#text-editor{width:100%;max-width:100%;overflow-wrap:break-word;min-height:100px;margin-top:0;margin-bottom:0}footer{position:fixed;bottom:0;left:50%;transform:translate(-50%,0%)}button{padding:5px}#main-planner,#main-notes,#main-write,#main-tables,#main-calculator{display:flex;flex-direction:column}#planner-ribbon>button{font-size:18px}main{min-height:320px}#planner-contacts-form *,#planner-calendar-form *{width:100%;display:auto;box-sizing:border-box}#planner-planner-help ul li,#tables-help ul li{list-style-position:inside;list-style-type:disc;margin:0 15px}#planner-planner-help ol li,#tables-help ol li{list-style-position:inside;list-style-type:decimal;margin:0 15px}#planner-planner-help p,#tables-help p{margin:15px}#planner-help,#tables-help pre{font-size:12px}.table-container table,.table-container table td,.table-container table th{border:1px solid #000;border-collapse:collapse}.table-container pre{white-space:pre-wrap;font-size:12px;word-break:break-all}.table-container table{box-sizing:border-box;margin:auto;width:100%}#contacts-table th,#contacts-table td,#calendar-table th,#calendar-table td{display:none}#calendar-table th:nth-of-type(1),#calendar-table th:nth-of-type(3),#calendar-table th:nth-of-type(6),#calendar-table td:nth-of-type(1),#calendar-table td:nth-of-type(3),#calendar-table td:nth-of-type(6){display:table-cell}#contacts-table td:nth-of-type(1),#contacts-table th:nth-of-type(1),#contacts-table th:nth-of-type(4),#contacts-table td:nth-of-type(4){display:table-cell}#contacts-table th:nth-of-type(3),#contacts-table td:nth-of-type(3){display:table-cell}#calendar-container{margin:10px;display:flex;flex-direction:column;align-items:center}#special-calendar{background-color:snow;font-family:Arial,Verdana,Helvetica,Tahoma,sans-serif;font-size:16px;padding:0;margin:0;background-color:#fff}#special-calendar table td{height:32px;text-align:center;width:32px}#special-calendar{border:1px solid grey;width:240px}#month-chooser{background-color:#f5f5f5;min-height:30px;border-radius:5px;width:240px;text-align:center;font-family:Arial,Helvetica,sans-serif;font-size:16px}#calendar-date{display:none}main h3{background-color:#e0e0e0}.nested-menu:hover{color:snow;background-color:grey}#tables-table th:hover:not(:first-of-type),#tables-table td:first-of-type:hover{background-color:#fff}#add-row:hover,#add-column:hover{background-color:#fff}#add-column{min-width:1rem}.table-container{display:block;overflow-x:auto;margin-left:auto;margin-right:auto;width:100%;text-align:center}#tables-table input{width:100%;border:none}#tables-table input:hover{background-color:lightgrey}#tables-table td{padding:0}#tables-table th:not(:last-of-type){min-width:3rem}#tables-table th:first-of-type{min-width:1rem}#tables-table{border:none}#tables-table th{border:none}.tables-table-row-number{border:none!important}#tables-table{background-color:lightgrey}#tables-table-table{}#tables-tables-header-form>div,#tables-tables-row-form>div{display:flex;flex-direction:column;text-align:center;width:50%;margin:auto}#tables-tables-header-form *,#tables-tables-row-form *{text-align:center}#tables-tables-header-form>div>div,#tables-tables-row-form>div>div{margin:5px 0}#tables-tables-header-form>div>div>*,#tables-tables-row-form>div>div>*{width:100%}#calculator-table{width:100%;min-width:0%}#calculator-table td button{font-size:2rem;width:100%;height:4rem}.special-calculator-button{background-color:#fc3;border:1px solid grey}#last-calculator-expression{overflow-wrap:anywhere;min-height:18px;color:grey}#calculator-input{width:100%;height:40px;font-size:1.4rem;text-align:right}#calc-clr button{width:50%;font-size:1.4rem;padding:5px}main nav button{background-color:#e0e0e0;border:1px solid grey;border-radius:3px}#startup-load-button,#startup-save-button{font-size:1.4rem}#planner-load,#planner-save{margin:40px}#planner-contacts-table,#planner-calendar-start{margin-top:1rem}#planner-contacts-table nav,#planner-calendar-start nav{min-height:36px}#new-contacts-button{font-size:1.4rem;padding:4px 10px}#contacts-table{margin-top:10px}</style><link id="favicon-link" rel="icon" type="image/x-icon" href="">
<title>bitOffice</title>
</head>

<body>
    <h1 onclick="alert(license);">bitOffice</h1>
    <nav id="top-nav">
        <button onclick="showMain('main-planner');">&#9742;&#128197;</button>
        <button onclick="showMain('main-notes');">&#128196;</button>
        <button onclick="showMain('main-write');">&#128221;</button>
        <button onclick="showMain('main-tables');">&#9638;</button>
        <button onclick="showMain('main-calculator');">&#128290;</button>
        <button onclick="saveSelf()">&darr;</button>
    </nav><main id="main-write">
    <h2>Write</h2>
    <nav id="file-bar">
        <button onclick="newDocument();">New</button>
        <button onclick="writeLoad();">Load</button>
        <button onclick="writeDataToJSON();">Save</button>
        <button onclick="exportToHTML()">Export</button>
        <button onclick="printDiv('document-parent');//window.print()">&#128424;</button>
    </nav>
    <nav id="document-settings">
        <button class="mono" onclick='processSelectedText(this);'>Mono</button>
        <button class="serif" onclick='processSelectedText(this);'>Serif</button>
        <button class="sans" onclick='processSelectedText(this);'>Sans</button>
        <button onclick='processSelectedText(this);//decrease font'><sup>A</sup>A</button>
        <button onclick='processSelectedText(this);//increase font;'><sub>A</sub>A</button>
        <button onclick='processSelectedText(this);//inc margin;'>&rarrb;&larrb;</button>
        <button onclick='processSelectedText(this);//dec margin;'>&larrb;&rarrb;</button>
        <button onclick='processSelectedText(this);//align left;'>&#8666;</button>
        <button onclick='processSelectedText(this);//align center;'>&#8667;&#8666;</button>
        <button onclick='processSelectedText(this);//align right;'>&#8667;</button>
        <button id="spell-check" onclick='processSelectedText(this);//spellcheck;'>&check;</button>
    </nav>
    <nav id="edit-bar">
        <button onclick='processSelectedText(this);'><b>B</b></button>
        <button onclick='processSelectedText(this);'><u>U</u></button>
        <button onclick='processSelectedText(this);'><em>I</em></button> &nbsp;
        <button onclick='processSelectedText(this);'>&#8633;</button>
        <button onclick='processSelectedText(this);//paragraph;'>&para;</button>
        <button onclick='processSelectedText(this);'>H1</button>
        <button onclick='processSelectedText(this);'>H2</button>
        <button onclick='processSelectedText(this);'>H3</button> &nbsp;
        <button onclick='processSelectedText(this);//horizontal rule'>&#8213;</button>
        <button onclick='processSelectedText(this);//bullet;'>&bullet;</button> &nbsp;
        <button onclick='processSelectedText(this);//undo;'>&#10226;</button>
        <button onclick="writeRedo()">&#10227;</button>
    </nav>
    <textarea id="text-editor" spellcheck="false" oninput="writeUpdateResult();"></textarea>
    <div id="document-parent">
        <div id="document-result"></div>
    </div>
</main><footer onclick="alert(license)">bitOffice &copy; 2022</footer><script>let license="MIT License\n\n\
Copyright (c) 2022 Gary Davenport\n\n\
Permission is hereby granted, free of charge, to any person obtaining a copy \
of this software and associated documentation files (the \"Software\"), to deal \
in the Software without restriction, including without limitation the rights \
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell \
copies of the Software, and to permit persons to whom the Software is \
furnished to do so, subject to the following conditions:\n\n\
The above copyright notice and this permission notice shall be included in all \
copies or substantial portions of the Software.\n\n\
THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \
SOFTWARE.";function saveStringToTextFile(str1,basename="myfile",fileType=".txt"){let filename=basename+fileType;let blobVersionOfText=new Blob([str1],{type:"text/plain",});let urlToBlob=window.URL.createObjectURL(blobVersionOfText);let downloadLink=document.createElement("a");downloadLink.style.display="none";downloadLink.download=filename;downloadLink.href=urlToBlob;document.body.appendChild(downloadLink);downloadLink.click();downloadLink.parentElement.removeChild(downloadLink);}
function copyAndSaveString(str1,basename="myfile",fileType=".txt"){copyToClipBoard(str1,false);if(confirm("Copied to clipboard, save to file also?")){saveStringToTextFile(str1,basename,fileType);}}
function saveWebsiteAsTextFile(url){let http=new XMLHttpRequest();http.timeout=2000;http.ontimeout=function(e){alert("The request timed out.");};http.open('GET',url,true);http.onreadystatechange=function(){if(http.readyState==4&&http.status==200){alert(http.responseText);console.log(http.responseText);}}
http.send();}
function saveSelf(){let docTitle=document.getElementsByTagName("title")[0].innerText;if(confirm("Duplicate and download "+docTitle+" ?")){saveStringToTextFile(selfString,docTitle+"Clone",".html");}}
function getTodaysDate(){let now=new Date();let day=("0"+now.getDate()).slice(-2);let month=("0"+(now.getMonth()+1)).slice(-2);let today=now.getFullYear()+"-"+month+"-"+day;return today;}
function getFirstDayOfThisMonthDate(){let now=new Date();let day="01";let month=("0"+(now.getMonth()+1)).slice(-2);return now.getFullYear()+"-"+month+"-"+day;}
function getLastDayOfThisMonthDate(){let now=new Date();let day=daysInThisMonth().toString();day="0"+day;day=day.slice(-2);let month=("0"+(now.getMonth()+1)).slice(-2);return now.getFullYear()+"-"+month+"-"+day;}
function daysInSomeMonth(someMonth,someYear){return new Date(someYear,someMonth+1,0).getDate();}
function daysInThisMonth(){thisDate=new Date();thisMonth=thisDate.getMonth();thisYear=thisDate.getYear();return daysInSomeMonth(thisMonth,thisYear);}
function getDayOfWeek(isoYearMonthDay){let d=new Date(isoYearMonthDay+"T00:00");return d.getDay();}
function serializeElementToPage(id,extraStyle=""){let boilerPlate1="<!DOCTYPE html><html lang='en'><head><meta charset='UTF-8'><meta http-equiv='X-UA-Compatible' content='IE=edge'><meta name='viewport' content='width=device-width, initial-scale=1.0'><title></title><style>";let allStyleTags=document.getElementsByTagName('style');let styleElementContent="";for(let i=0;i<allStyleTags.length;i++){styleElementContent=allStyleTags[i].innerHTML;}
let boilerPlate2="</style></head><body>";let boilerPlate3="</body></html>";let s=new XMLSerializer();let myElement=document.getElementById(id);let str=s.serializeToString(myElement);let htmlPage=boilerPlate1+styleElementContent+extraStyle+boilerPlate2+str+boilerPlate3;console.log(htmlPage);return htmlPage;}
function simulateUndo(){document.execCommand('undo',false,null);}
function simulateRedo(){document.execCommand('redo',false,null);}
function askConfirm(){return "Did you remember to save your data?";}
function showMain(id){let mains=document.getElementsByTagName('main');for(let main of mains){main.style.display="none";}
document.getElementById(id).style.display="flex";}
function copyToClipBoard(str,message=true){let el=document.createElement('textarea');el.value=str;el.setAttribute('readonly','');el.style={position:'absolute',left:'-9999px'};document.body.appendChild(el);el.select();document.execCommand('copy');document.body.removeChild(el);if(message){alert('Copied to Clipboard.');}
return(str);}
function fillInEmptyPropertyValues(table){let data=table["data"];let headers=table["headers"];for(let i=0;i<data.length;i++){for(let j=0;j<headers.length;j++){if(data[i][headers[j]]===undefined){data[i][headers[j]]="";}}}}
function makeCSV(thisTable,saveWithHeader=true){return JSONToCSV(thisTable,saveWithHeader,"\n");}
function tokenMaker(intSize){let token="";let specialString="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let index=0;for(let i=0;i<intSize;i++){token+=specialString[Math.floor(Math.random()*specialString.length)];}
console.log(token);return token;}
function processCSVClick(table){let thisCSV="";thisCSV=makeCSV(table,true);copyToClipBoard(thisCSV);if(confirm("Table copied to CSV.\n\nSave to file also?")){copyAndSaveString(thisCSV,table["name"]+getTodaysDate(),".csv");}}
function destructiveSort(arrayOfObjects,field,direction=1){if(direction!=-1){direction=1;}
arrayOfObjects.sort((a,b)=>{if(a[field]<b[field]){return-1*direction;}
if(a[field]>b[field]){return 1*direction;}
return 0;});}
function destructiveDoubleSortAscending(arrayOfObjects,date,time){arrayOfObjects.sort((a,b)=>{if(a[date]>b[date]){return 1;}
else if(a[date]<b[date]){return-1;}
if(a[time]>b[time]){return 1;}
else if(a[time]<b[time]){return-1;}
return 0;});}
function makeFavicon(letter,color,backgroundColor){let canvas=document.createElement('canvas');canvas.width=16;canvas.height=16;let ctx=canvas.getContext('2d');ctx.fillStyle=backgroundColor;ctx.fillRect(0,0,16,16);let ctx2=canvas.getContext("2d");ctx2.fillStyle=color;ctx2.font="bold 12px Arial";ctx2.fillText(letter,4,12);let link=document.getElementById("favicon-link");link.href=canvas.toDataURL("image/x-icon");}let textarea=document.getElementById("text-editor");let documentDiv=document.getElementById('document-result');let remSize=1;let marginSize=2;let writeUndos=[];let writeUndosCursor=0;let compareWriteData="";initializeWriteApp();let lastTextAreaText=textarea.value;function initializeWriteApp(){documentDiv.style.fontSize=remSize+"rem";documentDiv.style.marginLeft=marginSize+"rem";documentDiv.style.marginRight=marginSize+"rem";writeUndos.push(textarea.value);writeUpdateResult();textarea.spellcheck=false;textarea.focus();document.getElementById('text-editor').addEventListener('keydown',function(e){if(e.key=='Tab'){e.preventDefault();insertTab(this);updateUndosIfTextChanges();}});document.getElementById('text-editor').addEventListener('input',updateUndosIfTextChanges);compareWriteData=makeCompareWriteData();}
function updateUndosIfTextChanges(){console.log("called");console.log(writeUndos);if(lastTextAreaText!=textarea.value){addUndo();lastTextAreaText=textarea.value;}
console.log(writeUndos);}
function insertTab(aTextarea){let start=aTextarea.selectionStart;let end=aTextarea.selectionEnd;aTextarea.value=aTextarea.value.substring(0,start)+
"\t"+aTextarea.value.substring(end);aTextarea.selectionStart=aTextarea.selectionEnd=start+1;writeUpdateResult();}
function exportToHTML(){let contents=serializeElementToPage("document-parent","html,#document-result,#document-parent{background-color:white;}");copyToClipBoard(contents);if(confirm("HTML document exported to clipboard.\n\nWould you like to export to HTML file?")){saveStringToTextFile(contents,'write'+getTodaysDate(),'.html');}}
function newDocument(){if(confirm("This will overwrite current document.")){writeResetAll();}}
function writeResetAll(){writeBaseFilename="";remSize=1;marginSize=2;textarea.value="";documentDiv.style.textAlign="left";documentDiv.style.fontFamily="Georgia, 'Times New Roman', Garamond, Times, serif";documentDiv.style.fontSize="1rem";documentDiv.style.marginLeft="2rem";textarea.spellcheck=false;writeUndos=[];writeUndos.push(textarea.value);writeUpdateResult();textarea.focus();}
function makeCompareWriteData(){writeUpdateResult();let data={}
data["text"]=textarea.value;data["textAlign"]=documentDiv.style.textAlign;data["fontFamily"]=documentDiv.style.fontFamily;data["fontSize"]=documentDiv.style.fontSize;data["marginSize"]=documentDiv.style.marginLeft;data["spellCheck"]=textarea.spellcheck;return JSON.stringify(data);;}
function writeDataToJSON(){writeUpdateResult();let data={}
data["text"]=textarea.value;data["textAlign"]=documentDiv.style.textAlign;data["fontFamily"]=documentDiv.style.fontFamily;data["fontSize"]=documentDiv.style.fontSize;data["marginSize"]=documentDiv.style.marginLeft;data["spellCheck"]=textarea.spellcheck;writeBaseFilename="write"+getTodaysDate();let saveContents=JSON.stringify(data);saveStringToTextFile(saveContents,writeBaseFilename,".json");compareWriteData=makeCompareWriteData();}
function writeLoad(){console.log("writeLoad() called");console.log(textarea.value);console.log(textarea.value.length);let proceed=true;if(textarea.value.length!=0){proceed=confirm("This will overwrite current document");}
if(proceed){let fileContents="";let inputTypeIsFile=document.createElement('input');inputTypeIsFile.type="file";inputTypeIsFile.accept=".json";inputTypeIsFile.addEventListener("change",function(){let inputFile=inputTypeIsFile.files[0];let fileReader=new FileReader();fileReader.onload=function(fileLoadedEvent){fileContents=fileLoadedEvent.target.result;let loadedData=JSON.parse(fileContents);textarea.value=loadedData["text"];documentDiv.style.textAlign=loadedData["textAlign"];documentDiv.style.fontFamily=loadedData["fontFamily"];documentDiv.style.fontSize=loadedData["fontSize"];documentDiv.style.marginLeft=loadedData["marginSize"];textarea.spellcheck=loadedData["spellCheck"];writeUpdateResult();remSize=parseFloat(loadedData["fontSize"].split("rem")[0]);marginSize=parseFloat(loadedData["marginSize"].split("rem")[0]);writeUndos=[];console.log("writeUndos length",writeUndos.length);writeUndos.push(textarea.value);textarea.focus();};fileReader.readAsText(inputFile,"UTF-8");});inputTypeIsFile.click();}}
function addUndo(){console.log(writeUndos.length,writeUndosCursor);console.log(writeUndos);if(writeUndos.length-1===writeUndosCursor){console.log("we are at end");if(writeUndos.length>=316){writeUndos.shift();writeUndos.push(textarea.value);}else{writeUndos.push(textarea.value);writeUndosCursor+=1;}
console.log(writeUndos);}else{console.log("we are not at end");console.log(writeUndos);let removeNumberOfElements=writeUndos.length-(writeUndosCursor+1);writeUndos=writeUndos.slice(0,-removeNumberOfElements);console.log(writeUndos);writeUndos.push(textarea.value);writeUndosCursor+=1;console.log(writeUndos);}}
function backUndo(){console.log("back Undo called");console.log(writeUndos);console.log(writeUndosCursor);if(writeUndosCursor>0){let thisText=writeUndos[writeUndosCursor-1];textarea.value=thisText;writeUpdateResult();writeUndosCursor=writeUndosCursor-1;}
console.log(writeUndos);console.log(writeUndosCursor);}
function writeRedo(){console.log("redo called");if(writeUndos.length-1===writeUndosCursor){console.log("we are at end");}else{console.log("we are not at end");writeUndosCursor+=1;let thisText=writeUndos[writeUndosCursor];textarea.value=thisText;writeUpdateResult();}}
function processSelectedText(clickedElement){let action=clickedElement.innerHTML;console.log(action);if(action==="⇚"){documentDiv.style.textAlign="left";}else if(action==="⇛⇚"){documentDiv.style.textAlign="center";}else if(action==="⇛"){documentDiv.style.textAlign="right";}else if(action==="Mono"){documentDiv.style.fontFamily="'Courier New', Courier, monospace";}else if(action==="Serif"){documentDiv.style.fontFamily="Georgia, 'Times New Roman', Garamond, Times, serif";}else if(action==="Sans"){documentDiv.style.fontFamily="Arial, Verdana, Helvetica, Tahoma, sans-serif";}else if(action==="<sub>A</sub>A"){remSize=remSize+.2;documentDiv.style.fontSize=remSize.toString()+"rem";}else if(action==="<sup>A</sup>A"){remSize=remSize-.2;documentDiv.style.fontSize=remSize.toString()+"rem";}else if(action==="⇥⇤"){marginSize=marginSize+1;if(marginSize>20){marginSize=20;}
documentDiv.style.marginLeft=marginSize.toString()+"rem";documentDiv.style.marginRight=marginSize.toString()+"rem";}else if(action==="⇤⇥"){marginSize=marginSize-1;if(marginSize<0){marginSize=0;}
documentDiv.style.marginLeft=marginSize.toString()+"rem";documentDiv.style.marginRight=marginSize.toString()+"rem";}else if(action==="⟲"){backUndo();}else if(action==="✓"){console.log(textarea.spellcheck);textarea.spellcheck=!(textarea.spellcheck);console.log(textarea.spellcheck);textarea.focus();}
let len=textarea.value.length;let start=textarea.selectionStart;let end=textarea.selectionEnd;let sel=textarea.value.substring(start,end);let replace=sel;if(action==="<b>B</b>"){replace='<b>'+sel+'</b>';}else if(action==="<u>U</u>"){replace='<u>'+sel+'</u>';}else if(action==="<em>I</em>"){replace='<em>'+sel+'</em>';}else if(action==="H1"){replace='<h1>'+sel+'</h1>';}else if(action==="H2"){replace='<h2>'+sel+'</h2>';}else if(action==="H3"){replace='<h3>'+sel+'</h3>';}else if(action==="¶"){replace='<p>'+sel+'</p>';}else if(action==="―"){replace='<hr>'+sel;}else if(action==="•"){replace='&bullet; '+sel;}else if(action==="↹"){replace="\t"+sel;}
textarea.value=textarea.value.substring(0,start)+replace+textarea.value.substring(end,len);writeUpdateResult();textarea.selectionStart=start+replace.length;textarea.selectionEnd=start+replace.length;textarea.focus();if(action!="⟲"){updateUndosIfTextChanges();}}
function writeUpdateResult(){let currentContents=document.getElementById('text-editor').value;document.getElementById('document-result').innerHTML=currentContents.split('\n').join('<br>');if(textarea.spellcheck===true){document.getElementById("spell-check").style.color="green";}else{document.getElementById("spell-check").style.color="red";}}
function printDiv(id){let mySerializer=new XMLSerializer(id);let s=new XMLSerializer();let d=document;let str=s.serializeToString(d.getElementById(id));var a=window.open('','');a.document.write('<html>');a.document.write("<style> #document-result {overflow-wrap: break-word;width: auto;white-space: pre-wrap;} </style>");a.document.write(str);a.document.write('</body></html>');a.document.close();a.print();}let nestedMenues=document.getElementsByClassName("nested-menu");for(let nestedmenu of nestedMenues){nestedmenu.addEventListener("click",(evt)=>{toggleNest(evt.target)});}
function toggleNest(menu){let siblings=menu.parentElement.children;for(let sibling of siblings){if(sibling===menu){}else{if(sibling.style.display==="none"){sibling.style.display="inherit";}else{sibling.style.display="none";}}}}
function toggleAll(){for(let nestedmenu of nestedMenues){toggleNest(nestedmenu)}}
function openSelectedInitialNests(){for(let nestedmenu of nestedMenues){if(nestedmenu.classList.contains("initial-open")){toggleNest(nestedmenu);}}}
toggleAll();openSelectedInitialNests();</script><script>let selfString="";function createSelf(){let html=document.getElementsByTagName("html")[0].innerHTML;selfString+="<!DOCTYPE html><html lang='en'>"+html+"</html>";}
window.onload=createSelf();makeFavicon("p", "white", "mediumblue");
window.onbeforeunload = askConfirm;
document.getElementById("top-nav").style.display="none";
showMain('main-write');
</script></body>
</html>